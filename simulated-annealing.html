<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Meta -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta charset="utf-8">

    <title>Simulated Annealing &ndash; Gastón Amengual</title>

    <!-- PWA -->
    <link rel="manifest" href="https://gastonamengual.github.io/theme/site.webmanifest">
    <meta name="theme-color" content="#6A1A6A">
    <link rel="apple-touch-icon" sizes="180x180" href="https://gastonamengual.github.io/theme/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://gastonamengual.github.io/theme/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://gastonamengual.github.io/theme/favicon/favicon-16x16.png">
    <link rel="shortcut icon" type="image/png" href="https://gastonamengual.github.io/theme/favicon/favicon-32x32.png">

    <!-- Social -->
    <meta property="article:author" content="Gastón Amengual" />
    <meta property="article:section" content="Optimization" />
    <meta property="article:published_time" content="2020-09-25" />

    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Simulated Annealing"/>
    <meta property="og:description" content="Theoretical framework of the algorithm, including annealing schedules, and acceptance probability function. Implementation and application over benchmark functions. Evaluation with RMSE."/>
    <meta property="og:site_name" content="Gastón Amengual" />
    <meta property="og:url" content="https://gastonamengual.github.io/simulated-annealing.html"/>


    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Spartan:100,200,300,400,500,600,700,800,900">
    <link rel="stylesheet" type="text/css" href="https://gastonamengual.github.io/theme/css/w3.css">
    <link rel="stylesheet" type="text/css" href="https://gastonamengual.github.io/theme/css/style.css">
    <link href='fonts/fonts.css' rel='stylesheet'>
  </head>

  <body>
    <div class="w3-row w3-card w3-white">
      <header id="header">
        <img src="https://gastonamengual.github.io/theme/gaston_amengual.svg" id="header-logo">
        <nav id="header-menu">
          <ul>
            <li class="header-li"><a href="https://gastonamengual.github.io/">About</a></li>
            <li class="header-li"><a href="https://gastonamengual.github.io/pages/portfolio.html">Portfolio</a></li>
            <li class="header-li"><a href="/categories.html">Articles</a></li>
          </ul>
        </nav>
      </header>
    </div>



    <br><br>

    <article>
      <header class="w3-container col-main" style="display: flex; flex-direction: column;">
        <h1>Simulated Annealing</h1>
        <span style="margin-top: 1rem;"></span><a style="font-size: 1.6rem;" href="https://gastonamengual.github.io/category/optimization.html" title="All articles in category Optimization">Optimization</a></span>
        <span style="margin-top: 1rem; margin-bottom: 1rem;"><time datetime="2020-09-25T00:00:00+02:00">Fri 25 September 2020</time></span>

         
      </header>



      <div class="col-main w3-container">
        <section id="content">
          <p><strong>Notebook written by Gastón Amengual and <a href="https://elc.github.io" target="_blank">Ezequiel L. Castaño</a>.</strong></p>
<hr>

<h1>1 Theoretical Framework</h1>
<h2>1.1 Introduction</h2>
<p>Simulated annealing is a probabilistic technique for <strong>approximating the global minimum</strong> of a given function. It is often used when the search space is discrete, and for situations with a lot of local minima where algorithms like Gradient Descent would get stuck. The name of the algorithm comes from annealing in metallurgy, a technique involving <strong>heating and controlled cooling of a material</strong> to increase the size of its crystals and reduce their defects, both attributes depending on their thermodynamic free energy. Heating and cooling the material affects both the temperature and the thermodynamic free energy. </p>
<p>When applied to engineering design, an <strong>analogy is made between energy and the objective function</strong>. The algorithm simulates a small random displacement of an atom that results in a change in energy. The design starts at an initial state of <em>high temperature</em>, where it has a high objective. Then, random perturbations are made to the initial state, generating <em>neighbor</em> states. If the objective of a new state is lower (the change in energy is negative), the energy state of the new configuration is lower, and the new configuration is accepted. If the objective is higher (the change in energy is positive), the new configuration has a higher energy state, but can still be accepted according to some acceptance probability function.</p>
<p>The <strong>temperature progressively decreases</strong> from an initial positive value to a certain threshold according to a certain <em>annealing schedule</em>, simulating the slow cooling in the annealing process, and influences the probability of acceptance of a <em>neighbor</em> state. When the temperature is higher, is it more likely that worse solutions are accepted, encouraging the <strong>exploration</strong> of the search space and allows the algorithm to more likely travel down a sub-optimal path to potentially find a global minimum. On the other hand, when the temperature is lower, the algorithm is less likely to accept worse solutions, promoting <strong>exploitation</strong>, that is, once the algorithm is in the right search space, there is no need to search other sections of the search space, and it should instead try to converge and find the global minimum.</p>
<p>The simulation can be performed by using the stochastic sampling method, and it is an adaptation of the <strong>Metropolis–Hastings algorithm</strong>.</p>
<h2>1.2 Annealing Schedule</h2>
<p>The annealing procedure involves first "melting" the system at a high temperature, and then lowering the temperature by a constant factor <span class="math">\(\alpha \; (0 &lt; \alpha &lt; 1\)</span>), taking enough steps at each temperature to keep the system close to equilibrium, until the system approaches the ground state. Analogously, the algorithm starts with an initial temperature <span class="math">\(T_0\)</span> set to a high value, and then it is decreased at each step <span class="math">\(k\)</span> following some <em>annealing</em> or <em>cooling schedule</em> until it reaches <span class="math">\(0\)</span> towards the end. </p>
<p>There are several annealing schedules that can be considered.</p>
<h3>1.2.1 Linear Cooling Schedule</h3>
<p><span class="math">\(T(k) = T(k-1) - \alpha = T_0 - \alpha k\)</span></p>
<h3>1.2.2 Geometric Reduction Rule</h3>
<p><span class="math">\(T(k) = T(k-1) \cdot \alpha = T_0~\alpha^{k}\)</span> </p>
<h3>1.2.3 Slow-Decrease Rule</h3>
<p><span class="math">\(T(k) = \dfrac{T(k-1)}{1+\beta T(k-1)} = \dfrac{T_0}{\beta ~ k ~ T_0 + 1}\)</span>, where beta is an arbitrary constant</p>
<h3>1.2.4 Exponential Cooling Schedule</h3>
<p><span class="math">\(T(k) = T_0 \cdot e^{-\alpha k}\)</span></p>
<h3>1.2.5 Exponential Multiplicative Cooling Schedule</h3>
<p>Proposed by Kirkpatrick, Gelatt and Vecchi (1983)</p>
<p><span class="math">\(T_k = T_0 \cdot \alpha^k \quad (0.8 &lt; \alpha &lt; 0.9)\)</span></p>
<h2>1.3 Acceptance Probability Function</h2>
<p>The probability of making the transition from the current state <span class="math">\(s\)</span> to a neighbor state <span class="math">\(s_{\text{new}}\)</span> is specified by an acceptance probability function <span class="math">\(P(e, e_{\text{new}}, T)\)</span> that depends on the energies <span class="math">\(e = E(s)\)</span> and <span class="math">\(e_{\text{new}} = E(s_{\text{new}})\)</span> of the two states, and on the current temperature <span class="math">\(T\)</span>. States with a smaller energy are better than those with a greater energy. <span class="math">\(P\)</span> must be positive even when <span class="math">\(e_{\text{new}}\)</span> is greater than <span class="math">\(e\)</span>, to prevent the method from becoming stuck at a local minimum. When <span class="math">\(T \rightarrow 0\)</span>, <span class="math">\(P\)</span> must tend to <span class="math">\(0\)</span> if <span class="math">\(e_{\text{new}} &gt; e = E(s)\)</span>, and to a positive value otherwise.</p>
<h3>1.3.1 Boltzmann Distribution</h3>
<p>The Boltzmann or Gibbs distribution is a probability distribution that gives the probability that a system will be in a certain state as a function of that state's energy and the temperature of the system. The distribution is expressed in the form:</p>
<div class="math">$$p_i \propto e^{-\dfrac{\epsilon_i}{kT}}$$</div>
<p>where <span class="math">\(p_i\)</span> is the probability of the system being in state <span class="math">\(i\)</span>, <span class="math">\(\epsilon_i\)</span> is the energy of that state, and a constant <span class="math">\(k T\)</span> of the distribution is the product of Boltzmann's constant <span class="math">\(k\)</span> and thermodynamic temperature <span class="math">\(T\)</span>.</p>
<p>The present distribution will be considered as the <strong>acceptance distribution</strong>.</p>
<h2>1.4 Algorithm Description</h2>
<p><strong>1</strong> Set an objective function <span class="math">\(W(state)\)</span>, an initial state <span class="math">\(s_0\)</span>, an initial temperature <span class="math">\(T_0\)</span>, and an annealing schedule <span class="math">\(AS\)</span>.</p>
<p><strong>2</strong> Set a loop, the <em>temperature loop</em>. Inside it set a second loop, the <em>iteration loop</em>, which iterates <span class="math">\(n\)</span> iterations of Step 3, and then update the both the temperature, according to the <span class="math">\(AS\)</span>, and the variance as explained in step 3  The <em>temperature loop</em> stops once the temperature has reached an end value. </p>
<p><strong>3</strong> Generate a neighbor state <span class="math">\(s_{\text{new}}\)</span> from a symmetric distribution (e.g normal distribution), with <em>variance</em> equal to the current temperature by the function domain. Calculate the absolute value of the difference between the objective value of the current state and the new neighbor state, that is,  <span class="math">\(\Delta c = |W(s_0) - W(s_{\text{new}})|\)</span>. The probability of the new state being accepted is calculated as follows:</p>
<div class="math">$$\left\{\begin{matrix}
1 &amp; \text{if } S_0 \leq s_{\text{new}} \\ 
e^{-\Delta c / T(k)} &amp; \text{otherwise}
\end{matrix}\right.$$</div>
<p>where <span class="math">\(T(k)\)</span> is the temperature in the current iteration of the <em>temperature loop</em>.</p>
<h1>2 Implementation</h1>
<h2>2.1 Objective Functions</h2>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">objective_function1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Infinity77 - Univariate Problem 14&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">bounds1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">minimum1</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.2249</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7887</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">objective_function2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Ackley&quot;&quot;&quot;</span>
<span class="c1">#     x = x - 1</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">20</span> 
<span class="n">bounds2</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">]</span>
<span class="n">minimum2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">objective_function3</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="s2">&quot;Gramacy &amp; Lee&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span>
<span class="n">bounds3</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">]</span>
<span class="n">minimum3</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.1437791740738296</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.8738989416296277</span><span class="p">)</span> <span class="c1"># Only Numerical Solution</span>

<span class="k">def</span> <span class="nf">objective_function4</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Easom&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">pi</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span>
<span class="n">bounds4</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">minimum4</span> <span class="o">=</span> <span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">objective_function5</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Rastrigin&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">10</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span>
<span class="n">bounds5</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">5.12</span><span class="p">,</span> <span class="mf">5.12</span><span class="p">]</span>
<span class="n">minimum5</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">objective_function6</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Schwefel&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="n">bounds6</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span>
<span class="n">minimum6</span> <span class="o">=</span> <span class="p">(</span><span class="mf">420.9687</span><span class="p">,</span> <span class="o">-</span><span class="mf">418.9829</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">objective_function7</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Styblinski-Tang&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">16</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
<span class="n">bounds7</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">minimum7</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">2.903534</span><span class="p">,</span> <span class="o">-</span><span class="mf">39.16599</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">objective_function8</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Infinity77 - Univariate Problem 15&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">bounds8</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">minimum8</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">7</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>


<span class="n">objective_functions</span> <span class="o">=</span> <span class="p">[</span><span class="n">objective_function1</span><span class="p">,</span> <span class="n">objective_function2</span><span class="p">,</span> <span class="n">objective_function3</span><span class="p">,</span> <span class="n">objective_function4</span><span class="p">,</span> 
                       <span class="n">objective_function5</span><span class="p">,</span> <span class="n">objective_function6</span><span class="p">,</span> <span class="n">objective_function7</span><span class="p">,</span> <span class="n">objective_function8</span><span class="p">]</span>

<span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="n">bounds1</span><span class="p">,</span> <span class="n">bounds2</span><span class="p">,</span> <span class="n">bounds3</span><span class="p">,</span> <span class="n">bounds4</span><span class="p">,</span> <span class="n">bounds5</span><span class="p">,</span> <span class="n">bounds6</span><span class="p">,</span> <span class="n">bounds7</span><span class="p">,</span> <span class="n">bounds8</span><span class="p">]</span>

<span class="n">minima</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">minimum1</span><span class="p">,</span> <span class="n">minimum2</span><span class="p">,</span> <span class="n">minimum3</span><span class="p">,</span> <span class="n">minimum4</span><span class="p">,</span> <span class="n">minimum5</span><span class="p">,</span> <span class="n">minimum6</span><span class="p">,</span> <span class="n">minimum7</span><span class="p">,</span> <span class="n">minimum8</span><span class="p">])</span>
</code></pre></div>


<p><img alt="image alt text" src="https://gastonamengual.github.io/images/simulated_annealing_1.png"></p>
<h2>2.2 Simulated Annealing Algorithm</h2>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">simulated_annealing</span><span class="p">(</span><span class="n">objective_function</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">initial_temperature</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">final_temperature</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> 
                        <span class="n">maximize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">annealing_scheduler</span><span class="o">=</span><span class="n">slow_cooling</span><span class="p">,</span> 
                        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">0.30</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>

    <span class="n">current_temperature</span> <span class="o">=</span> <span class="n">initial_temperature</span>
    <span class="n">initial_solution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">*</span><span class="n">bounds</span><span class="p">)</span>

    <span class="n">best_solution</span> <span class="o">=</span> <span class="n">initial_solution</span>   
    <span class="n">best_value</span> <span class="o">=</span> <span class="n">objective_function</span><span class="p">(</span><span class="n">best_solution</span><span class="p">)</span>

    <span class="n">accepted_solutions</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">solutions_record</span> <span class="o">=</span> <span class="p">[</span><span class="n">best_solution</span><span class="p">]</span>
    <span class="n">values_record</span> <span class="o">=</span> <span class="p">[</span><span class="n">best_value</span><span class="p">]</span>
    <span class="n">temperature_record</span> <span class="o">=</span> <span class="p">[</span><span class="n">current_temperature</span><span class="p">]</span>
    <span class="n">variance</span> <span class="o">=</span> <span class="n">current_temperature</span> <span class="o">*</span> <span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>

        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>

            <span class="n">neighbor</span> <span class="o">=</span> <span class="n">best_solution</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">variance</span><span class="p">)</span>
            <span class="n">neighbor</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">neighbor</span><span class="p">,</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">neighbor_value</span> <span class="o">=</span> <span class="n">objective_function</span><span class="p">(</span><span class="n">neighbor</span><span class="p">)</span>

            <span class="n">delta_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">best_value</span> <span class="o">-</span> <span class="n">neighbor_value</span><span class="p">)</span>

            <span class="n">better</span> <span class="o">=</span> <span class="n">neighbor_value</span> <span class="o">&lt;=</span> <span class="n">best_value</span>

            <span class="k">if</span> <span class="n">maximize</span><span class="p">:</span>
                <span class="n">better</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">better</span>

            <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">better</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_c</span> <span class="o">/</span> <span class="n">current_temperature</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">p</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">best_solution</span> <span class="o">=</span> <span class="n">neighbor</span>
            <span class="n">best_value</span> <span class="o">=</span> <span class="n">neighbor_value</span>
            <span class="n">accepted_solutions</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">current_temperature</span> <span class="o">=</span> <span class="n">annealing_scheduler</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> <span class="n">total_steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
                                                  <span class="n">initial_temperature</span><span class="o">=</span><span class="n">initial_temperature</span><span class="p">)</span>
        <span class="n">variance</span> <span class="o">=</span> <span class="n">current_temperature</span> <span class="o">*</span> <span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">solutions_record</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">best_solution</span><span class="p">)</span>
        <span class="n">values_record</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">best_value</span><span class="p">)</span>
        <span class="n">temperature_record</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_temperature</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">solutions_record</span><span class="p">,</span> <span class="n">values_record</span><span class="p">,</span> <span class="n">temperature_record</span><span class="p">,</span> <span class="n">accepted_solutions</span><span class="o">/</span><span class="p">(</span><span class="n">iterations</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">temperature_record</span><span class="p">))</span>
</code></pre></div>


<h2>2.3 Annealing Schedules</h2>
<h3>2.3.1 Schedules Definition</h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">linear_cooling</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">initial_temperature</span><span class="p">,</span> <span class="n">total_steps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
    <span class="s2">&quot;Linear&quot;</span>
    <span class="k">if</span> <span class="n">total_steps</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">initial_temperature</span> <span class="o">/</span> <span class="n">total_steps</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">initial_temperature</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">initial_temperature</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">initial_temperature</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">k</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">geometric_cooling</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">initial_temperature</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
    <span class="s2">&quot;Geometric&quot;</span>
    <span class="k">return</span> <span class="n">initial_temperature</span> <span class="o">*</span> <span class="n">alpha</span><span class="o">**</span><span class="n">k</span>

<span class="k">def</span> <span class="nf">slow_cooling</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">initial_temperature</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
    <span class="s2">&quot;Slow&quot;</span>
    <span class="k">return</span> <span class="n">initial_temperature</span> <span class="o">/</span> <span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">k</span> <span class="o">*</span> <span class="n">initial_temperature</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">exponential_cooling</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">initial_temperature</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
    <span class="s2">&quot;Exponential&quot;</span>
    <span class="k">return</span> <span class="n">initial_temperature</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">k</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">exponential_multiplicative_cooling</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">initial_temperature</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
    <span class="s2">&quot;Exponential Multiplicative&quot;</span>
    <span class="k">assert</span> <span class="mf">0.8</span> <span class="o">&lt;</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mf">0.9</span>
    <span class="k">return</span> <span class="n">initial_temperature</span> <span class="o">*</span> <span class="n">a</span><span class="o">**</span><span class="n">k</span>

<span class="n">cooling_functions</span> <span class="o">=</span> <span class="p">[</span><span class="n">linear_cooling</span><span class="p">,</span> <span class="n">geometric_cooling</span><span class="p">,</span> <span class="n">slow_cooling</span><span class="p">,</span>
                     <span class="n">exponential_cooling</span><span class="p">,</span> <span class="n">exponential_multiplicative_cooling</span><span class="p">]</span>

<span class="n">cooling_functions_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">function</span><span class="o">.</span><span class="vm">__doc__</span> <span class="k">for</span> <span class="n">function</span> <span class="ow">in</span> <span class="n">cooling_functions</span><span class="p">])</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">cooling_schedules</span><span class="p">(</span><span class="n">initial_temperature</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">cooling_function</span> <span class="ow">in</span> <span class="n">cooling_functions</span><span class="p">:</span>
        <span class="n">temperatures</span> <span class="o">=</span> <span class="n">cooling_function</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span>  <span class="n">total_steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
                                        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">initial_temperature</span><span class="o">=</span><span class="n">initial_temperature</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">temperatures</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">cooling_function</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>     
</code></pre></div>


<h3>2.3.2 Schedules Comparison</h3>
<div class="highlight"><pre><span></span><code><span class="n">_</span><span class="p">,</span> <span class="n">optimal_values</span> <span class="o">=</span> <span class="n">minima</span><span class="o">.</span><span class="n">T</span>

<span class="n">cooling_function_rmse</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">cooling_function</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">cooling_functions</span><span class="p">):</span>
    <span class="n">average_rmse</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">function</span><span class="p">,</span> <span class="n">bound</span><span class="p">,</span> <span class="n">optimal_value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">objective_functions</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">optimal_values</span><span class="p">):</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">value_record</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">simulated_annealing</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">bound</span><span class="p">,</span> <span class="n">annealing_scheduler</span><span class="o">=</span><span class="n">cooling_function</span><span class="p">,</span>
                                                      <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>
            <span class="n">rmse</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value_record</span><span class="p">)</span> <span class="o">-</span> <span class="n">optimal_value</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>

        <span class="n">values_record</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">average_rmse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">values_record</span><span class="p">)</span>

    <span class="n">avg_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">average_rmse</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">cooling_function_rmse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">avg_rmse</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">avg_rmse</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="n">cooling_function</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</code></pre></div>


<p><img alt="image alt text" src="https://gastonamengual.github.io/images/simulated_annealing_2.png"></p>
<div class="highlight"><pre><span></span><code><span class="n">average_rmse_overall</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cooling_function_rmse</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">average_rmse_overall_10</span> <span class="o">=</span> <span class="n">average_rmse_overall</span><span class="p">[:,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">average_rmse_overall_20</span> <span class="o">=</span> <span class="n">average_rmse_overall</span><span class="p">[:,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">average_rmse_overall_50</span> <span class="o">=</span> <span class="n">average_rmse_overall</span><span class="p">[:,</span> <span class="mi">50</span><span class="p">]</span>
<span class="n">average_rmse_overall_100</span> <span class="o">=</span> <span class="n">average_rmse_overall</span><span class="p">[:,</span> <span class="mi">100</span><span class="p">]</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cooling_functions_names</span><span class="p">,</span> <span class="n">average_rmse_overall_10</span><span class="p">,</span> <span class="n">average_rmse_overall_20</span><span class="p">,</span> <span class="n">average_rmse_overall_50</span><span class="p">,</span> <span class="n">average_rmse_overall_100</span><span class="p">,])</span>

<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Function&quot;</span><span class="p">,</span> <span class="s2">&quot;Average RMSE (10)&quot;</span><span class="p">,</span> <span class="s2">&quot;Average RMSE (20)&quot;</span><span class="p">,</span> <span class="s2">&quot;Average RMSE (50)&quot;</span><span class="p">,</span> <span class="s2">&quot;Average RMSE (100)&quot;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">df</span>
</code></pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Function</th>
      <th>Average RMSE (10)</th>
      <th>Average RMSE (20)</th>
      <th>Average RMSE (50)</th>
      <th>Average RMSE (100)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Linear</td>
      <td>25.95</td>
      <td>15.802</td>
      <td>10.831</td>
      <td>0.959</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Geometric</td>
      <td>0.179</td>
      <td>0.066</td>
      <td>0.066</td>
      <td>0.066</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Slow</td>
      <td>1.258</td>
      <td>0.526</td>
      <td>0.188</td>
      <td>0.058</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Exponential</td>
      <td>0.919</td>
      <td>0.045</td>
      <td>0.043</td>
      <td>0.043</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Exponential Multiplicative</td>
      <td>13.672</td>
      <td>1.696</td>
      <td>0.017</td>
      <td>0.011</td>
    </tr>
  </tbody>
</table>
</div>

<h1>3 Optimization Execution</h1>
<div class="highlight"><pre><span></span><code><span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">objective_function</span><span class="p">,</span> <span class="n">bound</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">objective_functions</span><span class="p">,</span> <span class="n">bounds</span><span class="p">):</span>
    <span class="n">best_solutions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">best_values</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">)):</span>
        <span class="n">solutions_record</span><span class="p">,</span> <span class="n">values_record</span><span class="p">,</span> <span class="n">temperature_record</span><span class="p">,</span> <span class="n">accepted_proportions</span> <span class="o">=</span> <span class="n">simulated_annealing</span><span class="p">(</span><span class="n">objective_function</span><span class="p">,</span> <span class="n">bound</span><span class="p">)</span>
        <span class="n">best_solutions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">solutions_record</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">best_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">values_record</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">best_solutions</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">best_values</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">accepted_proportions</span><span class="p">)]</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</code></pre></div>


<h1>4 Results</h1>
<div class="highlight"><pre><span></span><code><span class="n">best_solution</span><span class="p">,</span> <span class="n">best_value</span><span class="p">,</span> <span class="n">acceptance_rate</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">T</span>
<span class="n">optimal_solution</span><span class="p">,</span> <span class="n">optimal_value</span> <span class="o">=</span> <span class="n">minima</span><span class="o">.</span><span class="n">T</span>

<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Solution Abs Error&#39;</span><span class="p">,</span> <span class="s1">&#39;Solution Rel Error&#39;</span><span class="p">,</span> <span class="s1">&#39;Value Abs Error&#39;</span><span class="p">,</span> <span class="s1">&#39;Value Rel Error&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Optimal Solution&#39;</span><span class="p">,</span> <span class="s1">&#39;Optimal Value&#39;</span><span class="p">,</span> <span class="s1">&#39;Acceptance Rate&#39;</span><span class="p">]</span>

<span class="n">function_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">function</span><span class="o">.</span><span class="vm">__doc__</span> <span class="k">for</span> <span class="n">function</span> <span class="ow">in</span> <span class="n">objective_functions</span><span class="p">])</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">best_solution</span> <span class="o">-</span> <span class="n">optimal_solution</span><span class="p">,</span> <span class="p">(</span><span class="n">best_solution</span> <span class="o">/</span> <span class="n">optimal_solution</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
                 <span class="n">best_value</span> <span class="o">-</span> <span class="n">optimal_value</span><span class="p">,</span> <span class="p">(</span><span class="n">best_value</span> <span class="o">/</span> <span class="n">optimal_value</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
                 <span class="n">optimal_solution</span><span class="p">,</span> <span class="n">optimal_value</span><span class="p">,</span> <span class="n">acceptance_rate</span><span class="o">*</span><span class="mi">100</span><span class="p">])</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Function&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">function_names</span><span class="o">.</span><span class="n">T</span>
</code></pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Solution Abs Error</th>
      <th>Solution Rel Error</th>
      <th>Value Abs Error</th>
      <th>Value Rel Error</th>
      <th>Optimal Solution</th>
      <th>Optimal Value</th>
      <th>Acceptance Rate</th>
      <th>Function</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.0003</td>
      <td>-0.1276</td>
      <td>0.0049</td>
      <td>-0.6231</td>
      <td>0.2249</td>
      <td>-0.7887</td>
      <td>62.5254</td>
      <td>Problem 14</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0002</td>
      <td>0.0193</td>
      <td>0.0061</td>
      <td>0.6137</td>
      <td>1.0000</td>
      <td>1.0000</td>
      <td>16.2463</td>
      <td>Ackley</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0001</td>
      <td>0.0492</td>
      <td>0.0052</td>
      <td>-0.1810</td>
      <td>0.1438</td>
      <td>-2.8739</td>
      <td>25.1149</td>
      <td>Gramacy &amp; Lee</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.0028</td>
      <td>-0.0883</td>
      <td>0.0050</td>
      <td>-0.4995</td>
      <td>3.1416</td>
      <td>-1.0000</td>
      <td>57.6597</td>
      <td>Easom</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.0001</td>
      <td>-0.0132</td>
      <td>0.0054</td>
      <td>0.5410</td>
      <td>1.0000</td>
      <td>1.0000</td>
      <td>8.6075</td>
      <td>Rastrigin</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.0047</td>
      <td>0.0011</td>
      <td>0.0051</td>
      <td>-0.0012</td>
      <td>420.9687</td>
      <td>-418.9829</td>
      <td>0.7030</td>
      <td>Schwefel</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.0002</td>
      <td>-0.0075</td>
      <td>0.0058</td>
      <td>-0.0148</td>
      <td>-2.9035</td>
      <td>-39.1660</td>
      <td>5.8015</td>
      <td>Styblinski-Tang</td>
    </tr>
  </tbody>
</table>
</div>

<hr>

<h1>References</h1>
<p>https://en.wikipedia.org/wiki/Simulated_annealing</p>
<p>https://www.youtube.com/watch?v=T28fr9wDZrg&amp;t=277s&amp;ab_channel=SolvingOptimizationProblems</p>
<p>https://towardsdatascience.com/optimization-techniques-simulated-annealing-d6a4785a1de7</p>
<p>http://what-when-how.com/artificial-intelligence/a-comparison-of-cooling-schedules-for-simulated-annealing-artificial-intelligence/</p>
<p>Problem 14: http://infinity77.net/global_optimization/test_functions_1d.html#go_benchmark.Problem14</p>
<p>Ackley: http://infinity77.net/global_optimization/test_functions_nd_A.html#go_benchmark.Ackley</p>
<p>Gramacy &amp; Lee: http://benchmarkfcns.xyz/benchmarkfcns/gramacyleefcn.html</p>
<p>Easom: http://www.geatbx.com/ver_3_3/fcneaso.html#:~:text=The%20Easom%20function%20%5BEas90%5D%20is,2%2Dpi)%5E2))%3B</p>
<p>Rastrigin: https://www.cs.unm.edu/~neal.holts/dga/benchmarkFunction/rastrigin.html</p>
<p>Schwefel: http://www.geatbx.com/ver_3_3/fcnfun7.html</p>
<p>Styblinski-Tang: https://www.sfu.ca/~ssurjano/stybtang.html</p>
<p>Problem 15: http://infinity77.net/global_optimization/test_functions_1d.html#go_benchmark.Problem15</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
        </section>

        <br><br>

        <footer>


        </footer>
      </div>
    </article>


    <footer id="footer">
      <div id="footer-copyright" class="w3-center w3-large w3-text-white w3-padding-48">
        <span>
          &copy;
          2021          Gastón Amengual
        </span>
      </div>
    </footer>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-6KC62F9717"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());
  gtag('config', "G-6KC62F9717");</script>    </body>
</html>