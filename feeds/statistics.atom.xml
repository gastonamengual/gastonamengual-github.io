<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Gastón Amengual - Statistics</title><link href="https://gastonamengual.github.io/" rel="alternate"></link><link href="https://gastonamengual.github.io/feeds/statistics.atom.xml" rel="self"></link><id>https://gastonamengual.github.io/</id><updated>2021-01-21T00:00:00+01:00</updated><entry><title>Confidence Intervals and Bootstrapping</title><link href="https://gastonamengual.github.io/confidence-intervals-and-bootstrapping.html" rel="alternate"></link><published>2021-01-21T00:00:00+01:00</published><updated>2021-01-21T00:00:00+01:00</updated><author><name>Gastón Amengual</name></author><id>tag:gastonamengual.github.io,2021-01-21:/confidence-intervals-and-bootstrapping.html</id><summary type="html">&lt;p&gt;Explanation of Confidence Intervals, Bootstrapping, and comparison.&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;strong&gt;Notebook written by Gastón Amengual.&lt;/strong&gt;&lt;/p&gt;
&lt;h1&gt;Confidence Intervals&lt;/h1&gt;
&lt;p&gt;A confidence interval is a type of estimate computed from the statistics of the observed data, and were introduced by Jerzy Neyman in 1937. This proposes a range of plausible values for an unknown parameter, like the population mean. The interval has an associated confidence level that the true parameter is in the proposed range. &lt;/p&gt;
&lt;p&gt;The confidence level represents the frequency of possible confidence intervals that contain the true value of the unknown population parameter. If confidence intervals are constructed using a given confidence level from an infinite number of independent sample statistics, the proportion of those intervals that contain the true value of the parameter will be equal to the confidence level. &lt;/p&gt;
&lt;p&gt;If an experiment in which a confidence interval is calculated is repeated infinite times, a certain percentage of the experiments will capture the population parameter in their confidence intervals. Most of the times, frequentists choose an interval that captures the population parameter 95% of the time, which be used in the following examples.&lt;/p&gt;
&lt;h2&gt;Interpretation&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;The confidence interval can be expressed in terms of repeated samples: Were this procedure to be repeated on numerous samples, the fraction of calculated confidence intervals (which would differ for each sample) that encompass the true population parameter would tend toward 95%.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The confidence interval can be expressed in terms of a single sample: There is a 90% probability that the calculated confidence interval from some future experiment encompasses the true value of the population parameter." It is crucial to note that this probability statement is about the confidence interval, not about the population parameter. This considers the probability associated with a confidence interval from a pre-experiment point of view, and it is known, before the actual experiment is carried out, that the single interval calculated has a particular chance of covering the true but unknown value.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The explanation of a confidence interval can amount to something like: "The confidence interval represents values for the population parameter for which the difference between the parameter and the observed estimate is not statistically significant at the 10% level".&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Calculation&lt;/h2&gt;
&lt;p&gt;It is assumed that the samples are drawn from an (approximately) normal distribution.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Identify the sample mean &lt;span class="math"&gt;\(\bar{x}\)&lt;/span&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;Population standard deviation &lt;span class="math"&gt;\(\sigma\)&lt;/span&gt; is known&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;span class="math"&gt;\(z^* = - \Phi^1 \left( \dfrac{\alpha}{2} \right)\)&lt;/span&gt;, where &lt;span class="math"&gt;\(\Phi\)&lt;/span&gt; is the CDF of the standard normal distribution (used as critical value), and the confidence level &lt;span class="math"&gt;\(C = 100(1 - \alpha)%\)&lt;/span&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span class="math"&gt;\(C \rightarrow Z^*\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\(99\% \rightarrow 2.576\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\(98\% \rightarrow 2.326\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\(95\% \rightarrow 1.96\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\(90\% \rightarrow 1.645\)&lt;/span&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The confidence interval is calculated as&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="math"&gt;$$\left( \bar{x} - z^*\dfrac{\sigma}{\sqrt{n}} \; , \; \bar{x} + z^*\dfrac{\sigma}{\sqrt{n}} \right)$$&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Population standard deviation &lt;span class="math"&gt;\(\sigma\)&lt;/span&gt; is unknown and estimated by the sample standard deviation &lt;span class="math"&gt;\(s\)&lt;/span&gt;.&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;If the population standard deviation is unknown t-values and the sample size is below 30, then the Student's t distribution is used as the critical value. This value is dependent on the confidence level (C) for the test and degrees of freedom. The degrees of freedom are found by subtracting one from the number of observations, n − 1. The critical value is found from the t-distribution table. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The confidence interval is calculated as&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="math"&gt;$$\left( \bar{x} - t^*\dfrac{s}{\sqrt{n}} \; , \; \bar{x} + t^*\dfrac{s}{\sqrt{n}} \right)$$&lt;/div&gt;
&lt;h2&gt;Cup Filling Example&lt;/h2&gt;
&lt;p&gt;A machine fills cups with a liquid, and is supposed to be adjusted so that the content of the cups is &lt;span class="math"&gt;\(250 g\)&lt;/span&gt; of liquid. As the machine cannot fill every cup with exactly 250 g, the content added to individual cups shows some variation, and is considered a random variable &lt;span class="math"&gt;\(X\)&lt;/span&gt;. This variation is assumed to be normally distributed around the desired average of &lt;span class="math"&gt;\(250 g\)&lt;/span&gt;, with a standard deviation &lt;span class="math"&gt;\(\sigma = 2.5 g\)&lt;/span&gt;. To determine if the machine is adequately calibrated, a sample of &lt;span class="math"&gt;\(n = 25\)&lt;/span&gt; cups of liquid is chosen at random and the cups are weighed. The resulting measured masses of liquid are &lt;span class="math"&gt;\(X_1, \dotsc, X_{25}\)&lt;/span&gt;, a random sample from &lt;span class="math"&gt;\(X\)&lt;/span&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;mean&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;250&lt;/span&gt;
&lt;span class="n"&gt;std&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt;
&lt;span class="n"&gt;sample_size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;
&lt;span class="n"&gt;z_score&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.96&lt;/span&gt; &lt;span class="c1"&gt;# for 95% confidence&lt;/span&gt;
&lt;span class="n"&gt;num_samples&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;

&lt;span class="n"&gt;contains_population_mean&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="n"&gt;confidence_intervals&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_samples&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;samples&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;normal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sample_size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;sample_mean&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;lower_bound&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sample_mean&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mf"&gt;1.96&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sample_size&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;upper_bound&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sample_mean&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mf"&gt;1.96&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sample_size&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;lower_bound&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;upper_bound&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;contains_population_mean&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; 
        &lt;span class="n"&gt;contains_population_mean&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;confidence_intervals&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;lower_bound&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;upper_bound&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

&lt;span class="n"&gt;confidence_level&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;contains_population_mean&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="image alt text" src="https://gastonamengual.github.io/images/confidence_intervals_and_bootstrapping_1.png"&gt;&lt;/p&gt;
&lt;h1&gt;Bootstrapping&lt;/h1&gt;
&lt;p&gt;On the example analyzed previously, both population mean and standard deviation were known. However, in real life that hardly happens, and it is only a single sample that can be worked with, and it is the best and only information possessed about the population.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Resampling&lt;/strong&gt; is a non-parametric method of statistical inference that consists of drawing repeated samples from the original data sample. &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Bootstrapping&lt;/strong&gt; is a resampling method for estimating quantities about a population by averaging estimates from multiple data samples, and can be used to estimate the confidence intervals. Bootstrapping is done with sampling with replacement, that is, the samples are constructed by drawing observations from data sample one at a time and returning them to the sample after they have been chosen, allowing an observation to be included in a sample more than once. &lt;/p&gt;
&lt;p&gt;Although other statistical techniques used to determine confidence intervals assume a known population mean or standard deviation, bootstrapping does not require anything other than a statistically significant sample, i.e. large enough (otherwise may derive in lack of validity to estimate the parameter).&lt;/p&gt;
&lt;p&gt;The &lt;strong&gt;steps of bootstrapping&lt;/strong&gt; are:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Repeat &lt;span class="math"&gt;\(n\)&lt;/span&gt; times:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Draw a sample with replacement of size equal to the original data set size.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Calculate and save the statistic on the sample.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Calculate the statistic of the calculated sample statistics.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;To sum up, bootstrapping does resampling with replacement maintaining data structure but reshuffling values, extrapolating to the population. It is useful for estimating statistical parameters where data are non-normal, have unknown statistical properties, or lack a standard calculation. Nonetheless, some parameters like variance and standard deviation ah inherently biased (underestimated) in bootstrapping, as extreme values on the edges tend to be rare to appear in bootstrap samples.&lt;/p&gt;
&lt;p&gt;Let us continue the previous Cup Filling Example, now calculating the confidence interval with a Bootstrap Resample approach.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;original_sample&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;normal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sample_size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;sample_mean_distribution&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;100000&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;bootstrap_sample&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;choice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;original_sample&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;original_sample&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;sample_mean_distribution&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bootstrap_sample&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="n"&gt;sample_mean_distribution&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sample_mean_distribution&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The &lt;span class="math"&gt;\(95\%\)&lt;/span&gt; confidence interval is constructed of the &lt;span class="math"&gt;\(2.25\)&lt;/span&gt; and &lt;span class="math"&gt;\(97.5\)&lt;/span&gt; percentiles.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;bootstrap_sorted&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sample_mean_distribution&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;lower_bound&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;percentile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bootstrap_sorted&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.25&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;upper_bound&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;percentile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bootstrap_sorted&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;97.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;mean&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sample_mean_distribution&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hist&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sample_mean_distribution&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bins&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;density&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95% confidence interval: (&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;lower_bound&lt;/span&gt;&lt;span class="si"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;.2f&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt;, &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;upper_bound&lt;/span&gt;&lt;span class="si"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;.2f&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt;)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;center&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Bootstrapped Resampling Mean Distribution - Mean: &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="si"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;.2f&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="image alt text" src="https://gastonamengual.github.io/images/confidence_intervals_and_bootstrapping_2.png"&gt;&lt;/p&gt;
&lt;p&gt;As can be observed, this method shows similar results as those produced by the analytic calculation, and approximates very efficiently the population mean.&lt;/p&gt;
&lt;h1&gt;References&lt;/h1&gt;
&lt;p&gt;https://www.wikiwand.com/en/Confidence_interval&lt;/p&gt;
&lt;p&gt;https://machinelearningmastery.com/a-gentle-introduction-to-the-bootstrap-method/&lt;/p&gt;
&lt;p&gt;https://www.thoughtco.com/example-of-bootstrapping-3126155&lt;/p&gt;
&lt;p&gt;https://www.statisticshowto.com/resampling-techniques/&lt;/p&gt;
&lt;p&gt;Resampling methods (bootstrapping) - Matthew E. Clapham - https://www.youtube.com/watch?v=gcPIyeqymOU &lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="Statistics"></category></entry><entry><title>Normal Distribution, Normality Test, and Central Limit Theorem</title><link href="https://gastonamengual.github.io/normal-distribution-normality-test-and-central-limit-theorem.html" rel="alternate"></link><published>2021-01-21T00:00:00+01:00</published><updated>2021-01-21T00:00:00+01:00</updated><author><name>Gastón Amengual</name></author><id>tag:gastonamengual.github.io,2021-01-21:/normal-distribution-normality-test-and-central-limit-theorem.html</id><summary type="html">&lt;p&gt;Introduction of Normal Distribution. Application of Normality Test to normal-like distributions. Explanation of the Central Limit Theorem, and verification with Normality Test for different combinations of sums of uniform, exponential, and normal samples of different sizes.&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;strong&gt;Notebook written by Gastón Amengual&lt;/strong&gt;.&lt;/p&gt;
&lt;h1&gt;1 Normal Distribuion&lt;/h1&gt;
&lt;p&gt;The Normal or Gaussian distribution is a continuous probability distribution for a real-valued random variable. The general form of its probability density function is:&lt;/p&gt;
&lt;div class="math"&gt;$$f(x) = \dfrac{1}{\sigma \sqrt{2 \pi}} e^{-\frac{1}{2} \left(\frac{x-\mu}{\sigma}\right)^2}$$&lt;/div&gt;
&lt;p&gt;The parameter &lt;span class="math"&gt;\(\mu\)&lt;/span&gt; is the mean or expectation, median, and mode of the distribution, while &lt;span class="math"&gt;\(\sigma\)&lt;/span&gt; is its standard deviation.&lt;/p&gt;
&lt;p&gt;The Standard Normal distribution is a special case when &lt;span class="math"&gt;\(\mu=0\)&lt;/span&gt; and &lt;span class="math"&gt;\(\sigma=1\)&lt;/span&gt;. The area under its curve equals one, it is symmetric around &lt;span class="math"&gt;\(x=0\)&lt;/span&gt;, and it has inflection points at &lt;span class="math"&gt;\(x \pm 1\)&lt;/span&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stats&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ppf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0001&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;stats&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ppf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.9999&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stats&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pdf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;lw&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;norm pdf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;hist&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hist&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;normal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;100000&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;density&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bins&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Standard Normal Distribution&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="image alt text" src="https://gastonamengual.github.io/images/normal_distribution_normality_test_and_central_limit_theorem_1.png"&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;bins_width&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;diff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;hist&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;bins_height&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hist&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; 
&lt;span class="n"&gt;sum_area_rectangles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bins_height&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;bins_width&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;The area under the curve equals &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;sum_area_rectangles&lt;/span&gt;&lt;span class="si"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;.3g&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;isclose&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sum_area_rectangles&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;It is a probability distribution.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;The area under the curve equals 1.&lt;/span&gt;
&lt;span class="err"&gt;It is a probability distribution.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;2 Standard Scores&lt;/h1&gt;
&lt;p&gt;The standard score, z-score, z-value, normal score, or standardized variable is the number of standard deviations by which the value of a raw score (i.e., an observed value or data point) is above or below the mean value of what is being observed or measured. Raw scores above the mean have positive standard scores, while those below the mean have negative standard scores.&lt;/p&gt;
&lt;p&gt;If the population mean &lt;span class="math"&gt;\(\mu\)&lt;/span&gt; and population standard deviation &lt;span class="math"&gt;\(\sigma\)&lt;/span&gt; are known, a raw score &lt;span class="math"&gt;\(x\)&lt;/span&gt; is converted into a standard score by&lt;/p&gt;
&lt;div class="math"&gt;$$z = \dfrac{x-\mu}{\sigma}$$&lt;/div&gt;
&lt;p&gt;When &lt;span class="math"&gt;\(\mu\)&lt;/span&gt; and &lt;span class="math"&gt;\(\sigma\)&lt;/span&gt; are unknown, the standard score may be calculated using the sample mean &lt;span class="math"&gt;\(\bar{x}\)&lt;/span&gt; and sample standard deviation &lt;span class="math"&gt;\(s\)&lt;/span&gt; as estimates of the population values:&lt;/p&gt;
&lt;div class="math"&gt;$$ z= \dfrac{x-\bar{x}}{s}$$&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;mu&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="n"&gt;sigma&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;normal_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;normal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1000000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;z_scores&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.645&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.96&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.326&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.576&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;z_score&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;z_scores&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;percentage&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;normal_data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;mu&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;z_score&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;z = &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;z_score&lt;/span&gt;&lt;span class="si"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;.3f&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt;: &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;percentage&lt;/span&gt;&lt;span class="si"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;.3f&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt;%&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;z = 1.000: 68.231%&lt;/span&gt;
&lt;span class="err"&gt;z = 1.645: 89.999%&lt;/span&gt;
&lt;span class="err"&gt;z = 1.960: 94.994%&lt;/span&gt;
&lt;span class="err"&gt;z = 2.326: 97.984%&lt;/span&gt;
&lt;span class="err"&gt;z = 2.576: 98.982%&lt;/span&gt;
&lt;span class="err"&gt;z = 3.000: 99.734%&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;3 Normality Test&lt;/h1&gt;
&lt;p&gt;Normality tests are used to determine if a data set is well-modeled by a normal distribution and to compute how likely it is for a random variable underlying the data set to be normally distributed. The scipy.stats.normaltest function will be used, which tests the null hypothesis that a sample comes from a normal distribution, and it is based on D’Agostino and Pearson’s test that combines skew and kurtosis to produce an omnibus test of normality.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;normal_test&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;distribution&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Null Hypothesis: The &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt; Distribution is a Normal Distribution&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;sizes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5000&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;sizes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;p_values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;distribution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p_value&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stats&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;normaltest&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;p_values&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p_value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="n"&gt;acceptance&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p_values&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mf"&gt;0.05&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;From 1000 samples of &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="si"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;4.0f&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt; elements, &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;acceptance&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="si"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;2.2f&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt;% of the time the null hypothesis was rejected&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;3.1 Normal-looking Custom Probability Function&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;custom_distribution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arctanh&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;choice&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;100000&lt;/span&gt;
&lt;span class="n"&gt;histogram&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;histogram&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;custom_distribution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;bins&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;density&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;sum_area_rectangles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;diff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;histogram&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;histogram&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;The area under the curve equals &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;sum_area_rectangles&lt;/span&gt;&lt;span class="si"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;.3g&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;isclose&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sum_area_rectangles&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;It is a probability distribution.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;The area under the curve equals 1.&lt;/span&gt;
&lt;span class="err"&gt;It is a probability distribution.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hist&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;custom_distribution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;bins&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;density&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Custom Distribution&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hist&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;normal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;firebrick&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;density&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bins&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Normal Distribution&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Comparison of Custom and Normal distributions&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="image alt text" src="https://gastonamengual.github.io/images/normal_distribution_normality_test_and_central_limit_theorem_2.png"&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;normal_test&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;custom_distribution&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Custom Distribution&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;Null Hypothesis: The Custom Distribution Distribution is a Normal Distribution&lt;/span&gt;
&lt;span class="err"&gt;From 1000 samples of   30 elements, 18.00% of the time the null hypothesis was rejected&lt;/span&gt;
&lt;span class="err"&gt;From 1000 samples of   50 elements, 25.20% of the time the null hypothesis was rejected&lt;/span&gt;
&lt;span class="err"&gt;From 1000 samples of  100 elements, 36.40% of the time the null hypothesis was rejected&lt;/span&gt;
&lt;span class="err"&gt;From 1000 samples of  200 elements, 56.30% of the time the null hypothesis was rejected&lt;/span&gt;
&lt;span class="err"&gt;From 1000 samples of  500 elements, 85.30% of the time the null hypothesis was rejected&lt;/span&gt;
&lt;span class="err"&gt;From 1000 samples of 1000 elements, 98.80% of the time the null hypothesis was rejected&lt;/span&gt;
&lt;span class="err"&gt;From 1000 samples of 2000 elements, 100.00% of the time the null hypothesis was rejected&lt;/span&gt;
&lt;span class="err"&gt;From 1000 samples of 5000 elements, 100.00% of the time the null hypothesis was rejected&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;3.2 Customized Beta Distribution&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;custom_beta&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;100000&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hist&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;custom_beta&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;bins&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;density&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Salmon&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Custom Beta Distribution&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hist&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;normal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Olivedrab&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;density&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bins&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Normal Distribution&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Comparison of Custom Beta and Normal distributions&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="image alt text" src="https://gastonamengual.github.io/images/normal_distribution_normality_test_and_central_limit_theorem_3.png"&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;normal_test&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;custom_beta&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Custom Beta&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;Null Hypothesis: The Custom Beta Distribution is a Normal Distribution&lt;/span&gt;
&lt;span class="err"&gt;From 1000 samples of   30 elements, 3.70% of the time the null hypothesis was rejected&lt;/span&gt;
&lt;span class="err"&gt;From 1000 samples of   50 elements, 4.40% of the time the null hypothesis was rejected&lt;/span&gt;
&lt;span class="err"&gt;From 1000 samples of  100 elements, 9.70% of the time the null hypothesis was rejected&lt;/span&gt;
&lt;span class="err"&gt;From 1000 samples of  200 elements, 21.00% of the time the null hypothesis was rejected&lt;/span&gt;
&lt;span class="err"&gt;From 1000 samples of  500 elements, 65.90% of the time the null hypothesis was rejected&lt;/span&gt;
&lt;span class="err"&gt;From 1000 samples of 1000 elements, 97.00% of the time the null hypothesis was rejected&lt;/span&gt;
&lt;span class="err"&gt;From 1000 samples of 2000 elements, 100.00% of the time the null hypothesis was rejected&lt;/span&gt;
&lt;span class="err"&gt;From 1000 samples of 5000 elements, 100.00% of the time the null hypothesis was rejected&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;4 Central Limit Theorem&lt;/h1&gt;
&lt;p&gt;Let &lt;span class="math"&gt;\(X_1, \dotsc, X_n\)&lt;/span&gt; be a random sample of size &lt;span class="math"&gt;\(n\)&lt;/span&gt;, i.e. a sequence of independent and identically distributed random variables from a distribution of expected value &lt;span class="math"&gt;\(\mu\)&lt;/span&gt; and finite variance &lt;span class="math"&gt;\(\sigma^2\)&lt;/span&gt;. The sample average of the random variables is &lt;/p&gt;
&lt;div class="math"&gt;$$\bar{X}_n = \dfrac{X_1 + \dotsc + X_n}{n}$$&lt;/div&gt;
&lt;p&gt;By the law of large numbers, the sample averages &lt;span class="math"&gt;\(\bar{X}_n $converge almost surely to the expected value $\mu\)&lt;/span&gt; as &lt;span class="math"&gt;\(n \to \infty\)&lt;/span&gt;. The Central Limit Theorem describes the size and the distributional form of the stochastic fluctuations around the deterministic number &lt;span class="math"&gt;\(\mu\)&lt;/span&gt; during this convergence. It states that, as &lt;span class="math"&gt;\(n\)&lt;/span&gt; gets larger, the distribution of the difference between the sample average &lt;span class="math"&gt;\(\bar{X}_n\)&lt;/span&gt; and its limit &lt;span class="math"&gt;\(\mu\)&lt;/span&gt;, when multiplied by the factor &lt;span class="math"&gt;\(\sqrt{n}\)&lt;/span&gt;, that is &lt;span class="math"&gt;\(\sqrt{n} ( \bar{X}_n -\mu)\)&lt;/span&gt;, approximates the normal distribution with mean &lt;span class="math"&gt;\(0\)&lt;/span&gt; and variance &lt;span class="math"&gt;\(\sigma^2\)&lt;/span&gt;. For large enough &lt;span class="math"&gt;\(n\)&lt;/span&gt;, the distribution of &lt;span class="math"&gt;\(\bar{X}_n\)&lt;/span&gt; is close to the normal distribution with mean &lt;span class="math"&gt;\(\mu\)&lt;/span&gt; and variance &lt;span class="math"&gt;\(\sigma^{2}/n\)&lt;/span&gt;. The usefulness of the theorem is that the distribution of &lt;span class="math"&gt;\(\sqrt{n} ( \bar{X}_n -\mu)\)&lt;/span&gt; approaches normality regardless of the shape of the distribution of the individual &lt;span class="math"&gt;\(X_i\)&lt;/span&gt;. This fact holds especially true for sample sizes over &lt;span class="math"&gt;\(30\)&lt;/span&gt;. As more samples are taken, especially large ones, the graph of the sample means looks more like a normal distribution. &lt;/p&gt;
&lt;p&gt;The Central Limit Theorem partially explains the prevalence of normal distributions in the natural world. Most characteristics of animals and other life forms are affected by a large number of genetic and environmental factors whose effect is additive. As the characteristics measure are the sum of a large number of small effects, so their distribution tends to be normal.&lt;/p&gt;
&lt;h2&gt;4.1 Die Roll Example&lt;/h2&gt;
&lt;p&gt;Suppose a die is rolled. The expected value of the dice is &lt;span class="math"&gt;\(E[X] = \sum_{i} x_i \cdot P(X = x_i) = \frac{1}{6} \cdot (1 + 2 + 3 + 4 + 5 + 6) = 3.5\)&lt;/span&gt;. Although it is not possible to obtain a &lt;span class="math"&gt;\(3.5\)&lt;/span&gt; on a roll of a die, with an increase in the number of die rolls, the average of the die rolls would be close to &lt;span class="math"&gt;\(3.5\)&lt;/span&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;axes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="n"&gt;sizes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;colors&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;mediumpurple&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;saddlebrown&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;deepskyblue&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;olivedrab&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;darkseagreen&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;darkkhaki&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;darkgoldenrod&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;darkcyan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;zip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;axes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;sizes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;means&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;randint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# Calculate mean of size samples of 10 uniform distibuted number&lt;/span&gt;
    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hist&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;means&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bins&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;density&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt; samples - $E[X]=&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;means&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="si"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;.3g&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt;$&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_axisbelow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;suptitle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Histogram of Expected Value of Die Rolls&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="image alt text" src="https://gastonamengual.github.io/images/normal_distribution_normality_test_and_central_limit_theorem_4.png"&gt;&lt;/p&gt;
&lt;p&gt;It can be observed that with a small number of samples, the histogram does not present a definite pattern. However, by increasing the sample size, the sampling distribution starts to resemble a normal distribution, demonstrating the Central Limit Theorem, and the most frequent average of &lt;span class="math"&gt;\(10\)&lt;/span&gt; die rolls is approximately &lt;span class="math"&gt;\(3.5\)&lt;/span&gt;.&lt;/p&gt;
&lt;h2&gt;4.2 Normal Tests for CLT&lt;/h2&gt;
&lt;p&gt;There are two parameters that can be varied when applying the Central Limit Theorem. The number of i.i.d. variables used to calculate the sample mean (10 in the previous example), hereafter called &lt;span class="math"&gt;\(n\)&lt;/span&gt;, and the number of sample means that are taken to form the sample mean distribution (5, 30, ..., 10000 in the previous example), hereafter called &lt;span class="math"&gt;\(r\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;In this section, the normal test will be applied for different combinations of &lt;span class="math"&gt;\(r\)&lt;/span&gt; and &lt;span class="math"&gt;\(n\)&lt;/span&gt; for the Uniform, Normal, and Exponential distributions, following the following &lt;strong&gt;Null Hypothesis&lt;/strong&gt;: &lt;/p&gt;
&lt;p&gt;&lt;em&gt;The number of &lt;span class="math"&gt;\(r\)&lt;/span&gt; sample means of &lt;span class="math"&gt;\(n\)&lt;/span&gt; i.i.d. variables of some distribution follows a Normal Distribution.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;For every &lt;span class="math"&gt;\(r-n\)&lt;/span&gt; combination, 1000 p-values will be calculated, along with the mean of how many of them were lower than the significance level.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;normal_test_varying_r_n&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;distribution&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;significance&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.05&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;rs&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;rs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;ns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5000&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

    &lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;tqdm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;p_values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;

            &lt;span class="c1"&gt;# Get p-value for 1000 samples of size (r, n) and calculate average&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;distribution&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p_value&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stats&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;normaltest&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="n"&gt;p_values&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p_value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

            &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p_values&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;significance&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;color_less_alpha&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;alpha&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.05&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;bg_color&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;forestgreen&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;bg_color&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;darkorange&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;bg_color&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;firebrick&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;background-color: &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;bg_color&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt;; color: white; font-weight: bold;&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;distributions&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uniform&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exponential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;normal&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;distribution&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;distributions&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;normal_test_varying_r_n&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;distribution&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_csv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;distribution&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="vm"&gt;__name__&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt;.csv&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;In the following matrices, &lt;span class="math"&gt;\(r\)&lt;/span&gt; will correspond to the rows, and &lt;span class="math"&gt;\(n\)&lt;/span&gt; to the columns, and each cells shows the percentage of times the null hypothesis was rejected. The pattern is as follows:&lt;/p&gt;
&lt;ul&gt;
    &lt;li style="font-weight: bold; color:green;"&gt;Null Hypothesis was rejected less than 5% of the times&lt;/li&gt;
    &lt;li style="font-weight: bold; color:goldenrod;"&gt;Null Hypothesis was rejected between 5% and 15% of the times&lt;/li&gt;
    &lt;li style="font-weight: bold; color:red;"&gt;Null Hypothesis was rejected more than 15% of the times&lt;/li&gt;
&lt;/ul&gt;

&lt;style  type="text/css" &gt;
    #T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cbe caption {
          font-size: 1.5rem;
          font-weight: bold;
    }#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow0_col0,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow0_col2,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow1_col0,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow1_col1,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow1_col2,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow2_col0,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow2_col2,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow3_col1,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow3_col3,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow4_col2,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow4_col3,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow4_col5,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow6_col2,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow6_col3,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow6_col4,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow6_col5{
            background-color:  forestgreen;
             color:  white;
             font-weight:  bold;
        }#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow0_col1,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow0_col3,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow0_col4,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow0_col5,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow1_col3,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow1_col4,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow1_col5,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow2_col1,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow2_col3,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow2_col4,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow2_col5,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow3_col0,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow3_col2,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow3_col4,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow3_col5,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow4_col0,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow4_col1,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow4_col4,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow5_col1,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow5_col2,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow5_col3,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow5_col4,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow5_col5,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow6_col1{
            background-color:  darkorange;
             color:  white;
             font-weight:  bold;
        }#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow5_col0,#T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow6_col0{
            background-color:  firebrick;
             color:  white;
             font-weight:  bold;
        }&lt;/style&gt;

&lt;table id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cbe" &gt;&lt;caption&gt;Uniform Samples&lt;/caption&gt;&lt;thead&gt;    &lt;tr&gt;        &lt;th class="index_name level0" &gt;n&lt;/th&gt;        &lt;th class="col_heading level0 col0" &gt;8&lt;/th&gt;        &lt;th class="col_heading level0 col1" &gt;30&lt;/th&gt;        &lt;th class="col_heading level0 col2" &gt;100&lt;/th&gt;        &lt;th class="col_heading level0 col3" &gt;500&lt;/th&gt;        &lt;th class="col_heading level0 col4" &gt;1000&lt;/th&gt;        &lt;th class="col_heading level0 col5" &gt;5000&lt;/th&gt;    &lt;/tr&gt;    &lt;tr&gt;        &lt;th class="index_name level0" &gt;r&lt;/th&gt;        &lt;th class="blank" &gt;&lt;/th&gt;        &lt;th class="blank" &gt;&lt;/th&gt;        &lt;th class="blank" &gt;&lt;/th&gt;        &lt;th class="blank" &gt;&lt;/th&gt;        &lt;th class="blank" &gt;&lt;/th&gt;        &lt;th class="blank" &gt;&lt;/th&gt;    &lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;
                &lt;tr&gt;
                        &lt;th id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cbelevel0_row0" class="row_heading level0 row0" &gt;30&lt;/th&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow0_col0" class="data row0 col0" &gt;4.8&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow0_col1" class="data row0 col1" &gt;6.2&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow0_col2" class="data row0 col2" &gt;4.9&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow0_col3" class="data row0 col3" &gt;7.2&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow0_col4" class="data row0 col4" &gt;6.2&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow0_col5" class="data row0 col5" &gt;5.9&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                        &lt;th id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cbelevel0_row1" class="row_heading level0 row1" &gt;50&lt;/th&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow1_col0" class="data row1 col0" &gt;4.1&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow1_col1" class="data row1 col1" &gt;4.6&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow1_col2" class="data row1 col2" &gt;4.4&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow1_col3" class="data row1 col3" &gt;5.9&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow1_col4" class="data row1 col4" &gt;5.2&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow1_col5" class="data row1 col5" &gt;5.7&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                        &lt;th id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cbelevel0_row2" class="row_heading level0 row2" &gt;100&lt;/th&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow2_col0" class="data row2 col0" &gt;2.8&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow2_col1" class="data row2 col1" &gt;5.1&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow2_col2" class="data row2 col2" &gt;4.7&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow2_col3" class="data row2 col3" &gt;5.1&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow2_col4" class="data row2 col4" &gt;6.6&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow2_col5" class="data row2 col5" &gt;5.7&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                        &lt;th id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cbelevel0_row3" class="row_heading level0 row3" &gt;500&lt;/th&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow3_col0" class="data row3 col0" &gt;5.7&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow3_col1" class="data row3 col1" &gt;5&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow3_col2" class="data row3 col2" &gt;5.8&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow3_col3" class="data row3 col3" &gt;4.7&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow3_col4" class="data row3 col4" &gt;6&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow3_col5" class="data row3 col5" &gt;5.5&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                        &lt;th id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cbelevel0_row4" class="row_heading level0 row4" &gt;1000&lt;/th&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow4_col0" class="data row4 col0" &gt;9.9&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow4_col1" class="data row4 col1" &gt;5.3&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow4_col2" class="data row4 col2" &gt;4.1&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow4_col3" class="data row4 col3" &gt;3.9&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow4_col4" class="data row4 col4" &gt;5.3&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow4_col5" class="data row4 col5" &gt;4.7&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                        &lt;th id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cbelevel0_row5" class="row_heading level0 row5" &gt;5000&lt;/th&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow5_col0" class="data row5 col0" &gt;53.7&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow5_col1" class="data row5 col1" &gt;8.3&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow5_col2" class="data row5 col2" &gt;5.6&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow5_col3" class="data row5 col3" &gt;5.3&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow5_col4" class="data row5 col4" &gt;5.3&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow5_col5" class="data row5 col5" &gt;5.6&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                        &lt;th id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cbelevel0_row6" class="row_heading level0 row6" &gt;10000&lt;/th&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow6_col0" class="data row6 col0" &gt;85.2&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow6_col1" class="data row6 col1" &gt;10&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow6_col2" class="data row6 col2" &gt;4.5&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow6_col3" class="data row6 col3" &gt;5&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow6_col4" class="data row6 col4" &gt;4&lt;/td&gt;
                        &lt;td id="T_ca8c9dcb_5bf0_11eb_959c_780cb8bb5cberow6_col5" class="data row6 col5" &gt;4.5&lt;/td&gt;
            &lt;/tr&gt;
    &lt;/tbody&gt;&lt;/table&gt;

&lt;style  type="text/css" &gt;
    #T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cbe caption {
          font-size: 1.5rem;
          font-weight: bold;
    }#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow0_col0,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow1_col0,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow2_col0,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow2_col1,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow3_col0,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow3_col1,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow3_col2,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow4_col0,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow4_col1,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow4_col2,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow4_col3,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow5_col0,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow5_col1,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow5_col2,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow5_col3,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow5_col4,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow6_col0,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow6_col1,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow6_col2,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow6_col3,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow6_col4{
            background-color:  firebrick;
             color:  white;
             font-weight:  bold;
        }#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow0_col1,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow0_col2,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow0_col3,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow0_col4,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow1_col1,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow1_col2,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow1_col3,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow1_col4,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow2_col2,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow2_col4,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow2_col5,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow3_col3,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow3_col4,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow4_col4,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow4_col5,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow5_col5,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow6_col5{
            background-color:  darkorange;
             color:  white;
             font-weight:  bold;
        }#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow0_col5,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow1_col5,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow2_col3,#T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow3_col5{
            background-color:  forestgreen;
             color:  white;
             font-weight:  bold;
        }&lt;/style&gt;

&lt;table id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cbe" &gt;&lt;caption&gt;Exponential Samples&lt;/caption&gt;&lt;thead&gt;    &lt;tr&gt;        &lt;th class="index_name level0" &gt;n&lt;/th&gt;        &lt;th class="col_heading level0 col0" &gt;8&lt;/th&gt;        &lt;th class="col_heading level0 col1" &gt;30&lt;/th&gt;        &lt;th class="col_heading level0 col2" &gt;100&lt;/th&gt;        &lt;th class="col_heading level0 col3" &gt;500&lt;/th&gt;        &lt;th class="col_heading level0 col4" &gt;1000&lt;/th&gt;        &lt;th class="col_heading level0 col5" &gt;5000&lt;/th&gt;    &lt;/tr&gt;    &lt;tr&gt;        &lt;th class="index_name level0" &gt;r&lt;/th&gt;        &lt;th class="blank" &gt;&lt;/th&gt;        &lt;th class="blank" &gt;&lt;/th&gt;        &lt;th class="blank" &gt;&lt;/th&gt;        &lt;th class="blank" &gt;&lt;/th&gt;        &lt;th class="blank" &gt;&lt;/th&gt;        &lt;th class="blank" &gt;&lt;/th&gt;    &lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;
                &lt;tr&gt;
                        &lt;th id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cbelevel0_row0" class="row_heading level0 row0" &gt;30&lt;/th&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow0_col0" class="data row0 col0" &gt;22.5&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow0_col1" class="data row0 col1" &gt;10.5&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow0_col2" class="data row0 col2" &gt;7.8&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow0_col3" class="data row0 col3" &gt;6&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow0_col4" class="data row0 col4" &gt;5.8&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow0_col5" class="data row0 col5" &gt;4.5&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                        &lt;th id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cbelevel0_row1" class="row_heading level0 row1" &gt;50&lt;/th&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow1_col0" class="data row1 col0" &gt;34.1&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow1_col1" class="data row1 col1" &gt;14.6&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow1_col2" class="data row1 col2" &gt;7.1&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow1_col3" class="data row1 col3" &gt;6.5&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow1_col4" class="data row1 col4" &gt;6&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow1_col5" class="data row1 col5" &gt;5&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                        &lt;th id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cbelevel0_row2" class="row_heading level0 row2" &gt;100&lt;/th&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow2_col0" class="data row2 col0" &gt;60.3&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow2_col1" class="data row2 col1" &gt;22.8&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow2_col2" class="data row2 col2" &gt;9.9&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow2_col3" class="data row2 col3" &gt;4.9&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow2_col4" class="data row2 col4" &gt;6.2&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow2_col5" class="data row2 col5" &gt;6.1&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                        &lt;th id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cbelevel0_row3" class="row_heading level0 row3" &gt;500&lt;/th&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow3_col0" class="data row3 col0" &gt;100&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow3_col1" class="data row3 col1" &gt;82.4&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow3_col2" class="data row3 col2" &gt;31.5&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow3_col3" class="data row3 col3" &gt;10.4&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow3_col4" class="data row3 col4" &gt;8.9&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow3_col5" class="data row3 col5" &gt;4.4&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                        &lt;th id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cbelevel0_row4" class="row_heading level0 row4" &gt;1000&lt;/th&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow4_col0" class="data row4 col0" &gt;100&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow4_col1" class="data row4 col1" &gt;99&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow4_col2" class="data row4 col2" &gt;61.8&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow4_col3" class="data row4 col3" &gt;17.2&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow4_col4" class="data row4 col4" &gt;12.3&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow4_col5" class="data row4 col5" &gt;7.6&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                        &lt;th id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cbelevel0_row5" class="row_heading level0 row5" &gt;5000&lt;/th&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow5_col0" class="data row5 col0" &gt;100&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow5_col1" class="data row5 col1" &gt;100&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow5_col2" class="data row5 col2" &gt;100&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow5_col3" class="data row5 col3" &gt;60.3&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow5_col4" class="data row5 col4" &gt;34.9&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow5_col5" class="data row5 col5" &gt;10.7&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                        &lt;th id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cbelevel0_row6" class="row_heading level0 row6" &gt;10000&lt;/th&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow6_col0" class="data row6 col0" &gt;100&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow6_col1" class="data row6 col1" &gt;100&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow6_col2" class="data row6 col2" &gt;100&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow6_col3" class="data row6 col3" &gt;90.9&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow6_col4" class="data row6 col4" &gt;63.5&lt;/td&gt;
                        &lt;td id="T_ca8fd1be_5bf0_11eb_9a4b_780cb8bb5cberow6_col5" class="data row6 col5" &gt;15&lt;/td&gt;
            &lt;/tr&gt;
    &lt;/tbody&gt;&lt;/table&gt;

&lt;style  type="text/css" &gt;
    #T_ca932c9e_5bf0_11eb_9756_780cb8bb5cbe caption {
          font-size: 1.5rem;
          font-weight: bold;
    }#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow0_col0,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow0_col1,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow0_col2,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow0_col3,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow0_col4,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow0_col5,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow1_col0,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow1_col1,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow1_col2,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow1_col3,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow1_col4,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow1_col5,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow2_col0,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow2_col1,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow2_col2,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow2_col3,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow2_col4,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow2_col5,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow3_col1,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow3_col2,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow4_col0,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow4_col3,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow4_col4,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow4_col5,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow5_col1,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow6_col0,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow6_col1,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow6_col2,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow6_col5{
            background-color:  darkorange;
             color:  white;
             font-weight:  bold;
        }#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow3_col0,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow3_col3,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow3_col4,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow3_col5,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow4_col1,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow4_col2,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow5_col0,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow5_col2,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow5_col3,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow5_col4,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow5_col5,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow6_col3,#T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow6_col4{
            background-color:  forestgreen;
             color:  white;
             font-weight:  bold;
        }&lt;/style&gt;

&lt;table id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cbe" &gt;&lt;caption&gt;Normal Samples&lt;/caption&gt;&lt;thead&gt;    &lt;tr&gt;        &lt;th class="index_name level0" &gt;n&lt;/th&gt;        &lt;th class="col_heading level0 col0" &gt;8&lt;/th&gt;        &lt;th class="col_heading level0 col1" &gt;30&lt;/th&gt;        &lt;th class="col_heading level0 col2" &gt;100&lt;/th&gt;        &lt;th class="col_heading level0 col3" &gt;500&lt;/th&gt;        &lt;th class="col_heading level0 col4" &gt;1000&lt;/th&gt;        &lt;th class="col_heading level0 col5" &gt;5000&lt;/th&gt;    &lt;/tr&gt;    &lt;tr&gt;        &lt;th class="index_name level0" &gt;r&lt;/th&gt;        &lt;th class="blank" &gt;&lt;/th&gt;        &lt;th class="blank" &gt;&lt;/th&gt;        &lt;th class="blank" &gt;&lt;/th&gt;        &lt;th class="blank" &gt;&lt;/th&gt;        &lt;th class="blank" &gt;&lt;/th&gt;        &lt;th class="blank" &gt;&lt;/th&gt;    &lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;
                &lt;tr&gt;
                        &lt;th id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cbelevel0_row0" class="row_heading level0 row0" &gt;30&lt;/th&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow0_col0" class="data row0 col0" &gt;5.3&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow0_col1" class="data row0 col1" &gt;5.2&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow0_col2" class="data row0 col2" &gt;7.2&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow0_col3" class="data row0 col3" &gt;6.8&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow0_col4" class="data row0 col4" &gt;7.2&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow0_col5" class="data row0 col5" &gt;5.8&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                        &lt;th id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cbelevel0_row1" class="row_heading level0 row1" &gt;50&lt;/th&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow1_col0" class="data row1 col0" &gt;5.6&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow1_col1" class="data row1 col1" &gt;5.6&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow1_col2" class="data row1 col2" &gt;6.3&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow1_col3" class="data row1 col3" &gt;5.3&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow1_col4" class="data row1 col4" &gt;5.7&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow1_col5" class="data row1 col5" &gt;5.2&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                        &lt;th id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cbelevel0_row2" class="row_heading level0 row2" &gt;100&lt;/th&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow2_col0" class="data row2 col0" &gt;5.2&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow2_col1" class="data row2 col1" &gt;5.2&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow2_col2" class="data row2 col2" &gt;5.1&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow2_col3" class="data row2 col3" &gt;6.2&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow2_col4" class="data row2 col4" &gt;5.5&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow2_col5" class="data row2 col5" &gt;6&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                        &lt;th id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cbelevel0_row3" class="row_heading level0 row3" &gt;500&lt;/th&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow3_col0" class="data row3 col0" &gt;4.6&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow3_col1" class="data row3 col1" &gt;6.6&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow3_col2" class="data row3 col2" &gt;5.3&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow3_col3" class="data row3 col3" &gt;4.3&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow3_col4" class="data row3 col4" &gt;3.9&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow3_col5" class="data row3 col5" &gt;4.6&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                        &lt;th id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cbelevel0_row4" class="row_heading level0 row4" &gt;1000&lt;/th&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow4_col0" class="data row4 col0" &gt;5.8&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow4_col1" class="data row4 col1" &gt;4.8&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow4_col2" class="data row4 col2" &gt;4.4&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow4_col3" class="data row4 col3" &gt;5.4&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow4_col4" class="data row4 col4" &gt;5.5&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow4_col5" class="data row4 col5" &gt;5.3&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                        &lt;th id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cbelevel0_row5" class="row_heading level0 row5" &gt;5000&lt;/th&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow5_col0" class="data row5 col0" &gt;3.9&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow5_col1" class="data row5 col1" &gt;5.8&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow5_col2" class="data row5 col2" &gt;5&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow5_col3" class="data row5 col3" &gt;4.1&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow5_col4" class="data row5 col4" &gt;4.6&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow5_col5" class="data row5 col5" &gt;4&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                        &lt;th id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cbelevel0_row6" class="row_heading level0 row6" &gt;10000&lt;/th&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow6_col0" class="data row6 col0" &gt;5.2&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow6_col1" class="data row6 col1" &gt;5.2&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow6_col2" class="data row6 col2" &gt;7.1&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow6_col3" class="data row6 col3" &gt;5&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow6_col4" class="data row6 col4" &gt;3.9&lt;/td&gt;
                        &lt;td id="T_ca932c9e_5bf0_11eb_9756_780cb8bb5cberow6_col5" class="data row6 col5" &gt;5.3&lt;/td&gt;
            &lt;/tr&gt;
    &lt;/tbody&gt;&lt;/table&gt;

&lt;h1&gt;References&lt;/h1&gt;
&lt;p&gt;https://en.wikipedia.org/wiki/Normal_distribution&lt;/p&gt;
&lt;p&gt;https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.normaltest.html&lt;/p&gt;
&lt;p&gt;https://www.wikiwand.com/en/Normality_test&lt;/p&gt;
&lt;p&gt;https://www.wikiwand.com/en/Central_limit_theorem&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="Statistics"></category></entry><entry><title>Covariance and Correlation</title><link href="https://gastonamengual.github.io/covariance-and-correlation.html" rel="alternate"></link><published>2020-12-10T00:00:00+01:00</published><updated>2020-12-10T00:00:00+01:00</updated><author><name>Gastón Amengual</name></author><id>tag:gastonamengual.github.io,2020-12-10:/covariance-and-correlation.html</id><summary type="html">&lt;p&gt;Explanation of Covariance and Correlation.&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;strong&gt;Notebook written by Gastón Amengual.&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;seaborn&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;sns&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;X&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;randn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;  &lt;span class="c1"&gt;#N(100,20)&lt;/span&gt;
&lt;span class="n"&gt;Y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;randn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;#N(50,10)&lt;/span&gt;

&lt;span class="n"&gt;Z1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;
&lt;span class="n"&gt;Z2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;1 Covariance&lt;/h1&gt;
&lt;p&gt;The covariance is defined as the average of the product between the values from each sample where the values haven been centered, i.e., had their mean subtracted.&lt;/p&gt;
&lt;div class="math"&gt;$$\text{cov}(X,Y) = \dfrac{\sum (x-\bar{x})(y-\bar{y})}{n - 1}$$&lt;/div&gt;
&lt;p&gt;Whereas the magnitude of the covariance is not easily interpreted, the sign of the covariance can be interpreted as:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Positive: the two variables change in the same direction.&lt;/li&gt;
&lt;li&gt;Negative: the two variables change in different directions.&lt;/li&gt;
&lt;li&gt;Zero: both variables are completely independent.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The variance is a special case of the covariance in which the two variables are identical: &lt;span class="math"&gt;\(cov(X,X) = var(X)\)&lt;/span&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;covariance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ddof&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;     
    &lt;span class="n"&gt;covariance&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Y&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;()))&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;ddof&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;covariance&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;covariance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;covariance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ddof&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;(4.406386324305738, 4.410797121427166)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;1.1 Covariance Matrix&lt;/h2&gt;
&lt;p&gt;The covariance matrix is a square matrix giving the covariance between each pair of elements of a given random vector.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;covariance_matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;covariance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ddof&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;covariance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ddof&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)],&lt;/span&gt;
        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;covariance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ddof&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;covariance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ddof&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)],&lt;/span&gt;
    &lt;span class="p"&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;covariance_matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;X&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Y&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;X&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Y&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;X&lt;/th&gt;
      &lt;th&gt;Y&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;X&lt;/th&gt;
      &lt;td&gt;406.550299&lt;/td&gt;
      &lt;td&gt;4.410797&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Y&lt;/th&gt;
      &lt;td&gt;4.410797&lt;/td&gt;
      &lt;td&gt;98.999061&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h1&gt;2 Correlation&lt;/h1&gt;
&lt;p&gt;Correlation or dependence is any statistical relationship, whether causal or not, between two random variables or bivariate data. It commonly refers to the degree to which a pair of variables are linearly related. For example, one variable could cause or depend on the values of another variable, one variable could be lightly associated with another variable, or two variables could depend on a third unknown variable.&lt;/p&gt;
&lt;p&gt;There are three kinds of correlations: &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Positive Correlation: both variables change in the same direction.&lt;/li&gt;
&lt;li&gt;Neutral Correlation: there is no relationship in the change of the variables, when one variable increases, the other one decrease.&lt;/li&gt;
&lt;li&gt;Negative Correlation: both variables change in opposite directions.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The structure of the relationship may be known (e.g., linear), or unknown. Depending what is known about the relationship and the distribution of the variables, different correlation scores can be calculated.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;scatter(X, Y): no correlation&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Z1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;scatter(X, Z1): positive correlation&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Z2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;scatter(X, Z2): negative correlation&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Scatter plots&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="image alt text" src="https://gastonamengual.github.io/images/covariance_and_correlation_1.png"&gt;&lt;/p&gt;
&lt;h2&gt;2.1 Pearson Correlation Coefficient&lt;/h2&gt;
&lt;p&gt;The Pearson correlation coefficient is a statistic developed by Karl Pearson that measures linear correlation between two variables. &lt;/p&gt;
&lt;p&gt;For a population, it is&lt;/p&gt;
&lt;div class="math"&gt;$$\rho_XY = \dfrac{\text{cov}(X,Y)}{\sigma_X \sigma_Y}$$&lt;/div&gt;
&lt;p&gt;For a sample, &lt;/p&gt;
&lt;div class="math"&gt;$$r_{xy} = \dfrac{\sum_{i=1}^{n}(x_i - \bar{x}) (y_i - \bar {y})} {\sqrt{\sum_{i=1}^{n}(x_i - \bar{x})^2)} \sqrt{\sum_{i=1}^{n}(y_i - \bar{y})^{2}}}$$&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;The correlation coefficient ranges from &lt;span class="math"&gt;\(−1\)&lt;/span&gt; to &lt;span class="math"&gt;\(1\)&lt;/span&gt;. &lt;/li&gt;
&lt;li&gt;The size of the correlation indicates the strength of the linear relationship between the variables. A value of &lt;span class="math"&gt;\(1\)&lt;/span&gt; indicates total positive linear correlation and implies that a linear equation describes the relationship between X and Y perfectly, with all data points lying on a line for which Y increases as X increases. A value of &lt;span class="math"&gt;\(−1\)&lt;/span&gt; indicates total negative linear correlation and implies that all data points lie on a line for which Y decreases as X increases. A value of &lt;span class="math"&gt;\(0\)&lt;/span&gt; implies that there is no linear correlation between the variables.&lt;/li&gt;
&lt;li&gt;If the coefficient is &lt;span class="math"&gt;\(0\)&lt;/span&gt;, there is no linear relationship between the variables (no linear correlation).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A strong correlation value dos not suggest that one variable causes the other: &lt;strong&gt;"correlation does not imply causation" refers to the inability to legitimately deduce a cause-and-effect relationship between two variables solely on the basis of an observed association or correlation between them&lt;/strong&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;pearson_correlation_sample&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;numerator&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Y&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;()))&lt;/span&gt; 
    &lt;span class="n"&gt;denominator&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;Y&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;numerator&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;denominator&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;p_corr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pearson_correlation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Z1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Pearson&amp;#39;s correlation index for X and Z1 is &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;p_corr&lt;/span&gt;&lt;span class="si"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;.5&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;p_corr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pearson_correlation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Pearson&amp;#39;s correlation index for X and Y is &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;p_corr&lt;/span&gt;&lt;span class="si"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;.5&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;p_corr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pearson_correlation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Z2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Pearson&amp;#39;s correlation index for X and Z2 is &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;p_corr&lt;/span&gt;&lt;span class="si"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;.5&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;Pearson&amp;#39;s correlation index for X and Z1 is 0.89868&lt;/span&gt;
&lt;span class="err"&gt;Pearson&amp;#39;s correlation index for X and Y is 0.021986&lt;/span&gt;
&lt;span class="err"&gt;Pearson&amp;#39;s correlation index for X and Z2 is -0.89487&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;2.2 Spearman's Rank Correlation Coefficient&lt;/h2&gt;
&lt;p&gt;Named after Charles Spearman, it is a nonparametric measure of rank correlation (statistical dependence between the rankings of two variables) that assesses how well the relationship between two variables can be described using a monotonic function (i.e., entirely nonincreasing or nondecreasing, its first derivative does not change sign).&lt;/p&gt;
&lt;p&gt;For two variables that may be related by a nonlinear relationship, such that the relationship is stronger or weaker across the distribution of the variables, or that may have a non-Normal distribution, the Spearman’s correlation coefficient can be used to summarize the strength between the two data samples.&lt;/p&gt;
&lt;p&gt;The scores are between -1 and 1 for perfectly negatively correlated variables and perfectly positively correlated respectively.&lt;/p&gt;
&lt;p&gt;Instead of calculating the coefficient using covariance and standard deviations on the samples themselves, these statistics are calculated from the relative rank of values on each sample. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;s_corr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stats&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spearmanr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Z1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Spearman&amp;#39;s correlation index for X and Z1 is &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;s_corr&lt;/span&gt;&lt;span class="si"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;.4&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;s_corr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stats&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spearmanr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Spearman&amp;#39;s correlation index for X and Y is &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;s_corr&lt;/span&gt;&lt;span class="si"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;.4&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;s_corr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stats&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spearmanr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Z2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Spearman&amp;#39;s correlation index for X and Z2 is &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;s_corr&lt;/span&gt;&lt;span class="si"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;.4&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;Spearman&amp;#39;s correlation index for X and Z1 is 0.8891&lt;/span&gt;
&lt;span class="err"&gt;Spearman&amp;#39;s correlation index for X and Y is 0.002445&lt;/span&gt;
&lt;span class="err"&gt;Spearman&amp;#39;s correlation index for X and Z2 is -0.8852&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;2.3 Correlation Matrix&lt;/h2&gt;
&lt;p&gt;The correlation matrix of &lt;span class="math"&gt;\(n\)&lt;/span&gt; random variables &lt;span class="math"&gt;\(X_1, \cdots, X_n\)&lt;/span&gt; is the &lt;span class="math"&gt;\(nxn\)&lt;/span&gt; matrix whose &lt;span class="math"&gt;\((i,j)\)&lt;/span&gt; entry is &lt;span class="math"&gt;\(corr(X_i, X_j)\)&lt;/span&gt;. It is symmetric, as &lt;span class="math"&gt;\(corr(X_i, X_j) = corr(X_j, X_i)\)&lt;/span&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Z1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Z2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;X&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Y&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Z1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Z2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

&lt;span class="n"&gt;correlation_matrix&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;corr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pearson&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;sns&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;heatmap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;correlation_matrix&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;YlGnBu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;annot&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;cbar&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;square&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Correlation Matrix&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="image alt text" src="https://gastonamengual.github.io/images/covariance_and_correlation_2.png"&gt;&lt;/p&gt;
&lt;h1&gt;References&lt;/h1&gt;
&lt;p&gt;https://www.wikiwand.com/en/Correlation_and_dependence&lt;/p&gt;
&lt;p&gt;https://www.wikiwand.com/en/Pearson_correlation_coefficient&lt;/p&gt;
&lt;p&gt;https://www.wikiwand.com/en/Spearman%27s_rank_correlation_coefficient&lt;/p&gt;
&lt;p&gt;https://www.statisticshowto.com/covariance/&lt;/p&gt;
&lt;p&gt;https://www.statisticshowto.com/probability-and-statistics/correlation-analysis/&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="Statistics"></category></entry></feed>