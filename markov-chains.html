<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Meta -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta charset="utf-8">

    <title>Markov Chains &ndash; Gastón Amengual</title>

    <!-- PWA -->
    <link rel="manifest" href="https://gastonamengual.github.io/theme/site.webmanifest">
    <meta name="theme-color" content="#6A1A6A">
    <link rel="apple-touch-icon" sizes="180x180" href="https://gastonamengual.github.io/theme/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://gastonamengual.github.io/theme/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://gastonamengual.github.io/theme/favicon/favicon-16x16.png">
    <link rel="shortcut icon" type="image/png" href="https://gastonamengual.github.io/theme/favicon/favicon-32x32.png">

    <!-- Social -->
    <meta property="article:author" content="Gastón Amengual" />
    <meta property="article:section" content="Statistics" />
    <meta property="article:published_time" content="2021-01-19" />

    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Markov Chains"/>
    <meta property="og:description" content="The concept of Discrete and Continuous Markov Chains is explained. An example of Monte Carlo sampling from the chain&#39;s stationary distribution is developed."/>
    <meta property="og:site_name" content="Gastón Amengual" />
    <meta property="og:url" content="https://gastonamengual.github.io/markov-chains.html"/>


    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Spartan:100,200,300,400,500,600,700,800,900">
    <link rel="stylesheet" type="text/css" href="https://gastonamengual.github.io/theme/style.css">
    <link href='fonts/fonts.css' rel='stylesheet'>
  </head>

  <body>
    <div id="navbar">
        <a href="../index.html"><img src="https://gastonamengual.github.io/theme/gaston_amengual.svg" id="navbar-logo"></a>
        <nav id="navbar-menu">
          <ul>
            
              <li class="navbar-li"><a href="/index.html">Home</a></li>
              <li class="navbar-li"><a href="/pages/about.html">About</a></li>
              <li class="navbar-li"><a href="/pages/portfolio.html">Portfolio</a></li>
              <li class="navbar-li"><a href="/categories.html">Articles</a></li>
          </ul>
        </nav>
    </div>



    <br><br>

    <article class="article-article">
      <header class="col-main article-header">
        <h1>Markov Chains</h1>
        <a class="article-category" href="https://gastonamengual.github.io/category/statistics.html">Statistics</a>
        <time class="article-date" datetime="2021-01-19T00:00:00-03:00">Tue 19 January 2021</time>
      </header>

      <div class="col-main">
        <section class="article-content">
          <p><strong>Notebook written by Gastón Amengual.</strong></p>
<hr>

<h1>Definition</h1>
<p>A Markov chain is a stochastic model describing a sequence of possible events in which the probability of each event depends only on the state attained in the previous event, named after the Russian mathematician Andrey Markov.</p>
<p>A countably infinite sequence, in which the chain moves state at discrete time steps, gives a discrete-time Markov chain, while a continuous-time process is called a continuous-time Markov chain. </p>
<p>Given a sequence of random variables <span class="math">\(X_1, X_2, …, X_n\)</span> where the indices <span class="math">\(1, 2, …, n\)</span> represent successive points in time, the chain rule of probability can be used to calculate the probability of the entire sequence:</p>
<p><span class="math">\(p(X_1,X_2,…X_n) = p(X_1) \cdot p(X_2|X_1) \cdot p(X_3|X_2,X_1) \cdot … \cdot p(X_n|X_{n−1}, X_{n−2}, …, X_2, X_1)\)</span>.</p>
<p>Markov chains simplify this expression by using the Markov assumption: given the entire past history, the probability distribution for the random variable at the next time step only depends on the current variable. Mathematically, the assumption is written like this:</p>
<p><span class="math">\(p(X_{t+1} | X_t, X_{t−1}, …, X_2, X_1) = p(X_{t+1} | X_t)\)</span></p>
<p>for all <span class="math">\(t = 2, …, n\)</span>. Under this assumption, the first expression can be written as</p>
<p><span class="math">\(p(X_1, X_2, …, X_n) = p(X_1) \cdot p(X_2|X_1) \cdot p(X_3|X_2) \cdot (X_4|X_3) \cdot … \cdot p(X_n|X_{n−1})\)</span>,</p>
<p>which is much simpler than the original. It consists of an initial distribution for the first variable <span class="math">\(p(X_1)\)</span> and <span class="math">\(n−1\)</span> transition probabilities. One more assumption is generally made: the transition probabilities do not change with time. Hence, the transition from time <span class="math">\(t\)</span> to time <span class="math">\(t+1\)</span> depends only on the value of <span class="math">\(X_t\)</span>.</p>
<h1>Discrete Markov Chain</h1>
<p>Suppose an initial integer secret number between 1 and 5. For each time step, the secret number will change according to the following:</p>
<ol>
<li>Flip a coin.</li>
<li>If the coin turns up heads, then increase your secret number by one (5 increases to 1). If the coin turns up tails, then decrease your secret number by one (1 decreases to 5).</li>
<li>Repeat n times, and record the evolving history of your secret number.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">coin_flip_markov_chain</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>

    <span class="n">secret_number</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">numbers</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">flip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">flip</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
            <span class="k">if</span> <span class="n">secret_number</span> <span class="o">!=</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">secret_number</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">secret_number</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">flip</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">secret_number</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">secret_number</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">secret_number</span> <span class="o">=</span> <span class="mi">5</span>

        <span class="n">numbers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">secret_number</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coin_flip_markov_chain</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">coin_flip_markov_chain</span><span class="p">(</span><span class="mi">100000</span><span class="p">))</span>
</code></pre></div>


<p><img alt="image alt text" src="https://gastonamengual.github.io/images/markov_chains_1.png"></p>
<p><img alt="image alt text" src="https://gastonamengual.github.io/images/markov_chains_2.png"></p>
<h2>State-transition Matrix</h2>
<p>If it is assumed that transition probabilities do not change with time, then there are a total of 25 potential transition probabilities (from State 1 to State 2, State 1 to State 3, and so forth), which can be arranged into a matrix <span class="math">\(Q\)</span>. The transition matrix is especially useful to find the probabilities associated with multiple steps of the chain, like <span class="math">\(p(X_{t+2} = 3 ∣ X_t = 1)\)</span>, i.e. the probability of the secret number being 3 two steps from now, given that it is currently 1. This can be calculated as <span class="math">\(\sum_{k=1}^{5} p(X_{t+2} = 3 ∣ X_{t+1} = k) \cdot p(X_{t+1}= k ∣ X_t = 1)\)</span>, the first row and third column of <span class="math">\(Q^2\)</span>.</p>
<div class="highlight"><pre><span></span><code><span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;If the secret number is currently 1, the probability that the number will be 3 two steps from now is </span><span class="si">{</span><span class="p">(</span><span class="n">Q</span> <span class="o">@</span> <span class="n">Q</span><span class="p">)[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">powers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="k">for</span> <span class="n">power</span> <span class="ow">in</span> <span class="n">powers</span><span class="p">:</span>
    <span class="n">Q_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">power</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Probability distribution of the secret number in </span><span class="si">{</span><span class="n">power</span><span class="si">}</span><span class="s1"> steps&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q_exp</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="k">If</span> <span class="n">the</span> <span class="n">secret</span> <span class="nb">number</span> <span class="k">is</span> <span class="n">currently</span> <span class="mi">1</span><span class="p">,</span> <span class="n">the</span> <span class="n">probability</span> <span class="n">that</span> <span class="n">the</span> <span class="nb">number</span> <span class="n">will</span> <span class="n">be</span> <span class="mi">3</span> <span class="n">two</span> <span class="n">steps</span> <span class="k">from</span> <span class="n">now</span> <span class="k">is</span> <span class="mi">0</span><span class="p">.</span><span class="mi">25</span>

<span class="n">Probability</span> <span class="n">distribution</span> <span class="k">of</span> <span class="n">the</span> <span class="n">secret</span> <span class="nb">number</span> <span class="k">in</span> <span class="mi">5</span> <span class="n">steps</span>
<span class="p">[[</span><span class="mi">0</span><span class="p">.</span><span class="mi">0625</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">3125</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">15625</span> <span class="mi">0</span><span class="p">.</span><span class="mi">15625</span> <span class="mi">0</span><span class="p">.</span><span class="mi">3125</span> <span class="p">]</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">3125</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0625</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">3125</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">15625</span> <span class="mi">0</span><span class="p">.</span><span class="mi">15625</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">15625</span> <span class="mi">0</span><span class="p">.</span><span class="mi">3125</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0625</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">3125</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">15625</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">15625</span> <span class="mi">0</span><span class="p">.</span><span class="mi">15625</span> <span class="mi">0</span><span class="p">.</span><span class="mi">3125</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0625</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">3125</span> <span class="p">]</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">3125</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">15625</span> <span class="mi">0</span><span class="p">.</span><span class="mi">15625</span> <span class="mi">0</span><span class="p">.</span><span class="mi">3125</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0625</span> <span class="p">]]</span>

<span class="n">Probability</span> <span class="n">distribution</span> <span class="k">of</span> <span class="n">the</span> <span class="n">secret</span> <span class="nb">number</span> <span class="k">in</span> <span class="mi">10</span> <span class="n">steps</span>
<span class="p">[[</span><span class="mi">0</span><span class="p">.</span><span class="mi">24804688</span> <span class="mi">0</span><span class="p">.</span><span class="mi">16113281</span> <span class="mi">0</span><span class="p">.</span><span class="mi">21484375</span> <span class="mi">0</span><span class="p">.</span><span class="mi">21484375</span> <span class="mi">0</span><span class="p">.</span><span class="mi">16113281</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">16113281</span> <span class="mi">0</span><span class="p">.</span><span class="mi">24804688</span> <span class="mi">0</span><span class="p">.</span><span class="mi">16113281</span> <span class="mi">0</span><span class="p">.</span><span class="mi">21484375</span> <span class="mi">0</span><span class="p">.</span><span class="mi">21484375</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">21484375</span> <span class="mi">0</span><span class="p">.</span><span class="mi">16113281</span> <span class="mi">0</span><span class="p">.</span><span class="mi">24804688</span> <span class="mi">0</span><span class="p">.</span><span class="mi">16113281</span> <span class="mi">0</span><span class="p">.</span><span class="mi">21484375</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">21484375</span> <span class="mi">0</span><span class="p">.</span><span class="mi">21484375</span> <span class="mi">0</span><span class="p">.</span><span class="mi">16113281</span> <span class="mi">0</span><span class="p">.</span><span class="mi">24804688</span> <span class="mi">0</span><span class="p">.</span><span class="mi">16113281</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">16113281</span> <span class="mi">0</span><span class="p">.</span><span class="mi">21484375</span> <span class="mi">0</span><span class="p">.</span><span class="mi">21484375</span> <span class="mi">0</span><span class="p">.</span><span class="mi">16113281</span> <span class="mi">0</span><span class="p">.</span><span class="mi">24804688</span><span class="p">]]</span>

<span class="n">Probability</span> <span class="n">distribution</span> <span class="k">of</span> <span class="n">the</span> <span class="n">secret</span> <span class="nb">number</span> <span class="k">in</span> <span class="mi">20</span> <span class="n">steps</span>
<span class="p">[[</span><span class="mi">0</span><span class="p">.</span><span class="mi">20577049</span> <span class="mi">0</span><span class="p">.</span><span class="mi">19533157</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20178318</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20178318</span> <span class="mi">0</span><span class="p">.</span><span class="mi">19533157</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">19533157</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20577049</span> <span class="mi">0</span><span class="p">.</span><span class="mi">19533157</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20178318</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20178318</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">20178318</span> <span class="mi">0</span><span class="p">.</span><span class="mi">19533157</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20577049</span> <span class="mi">0</span><span class="p">.</span><span class="mi">19533157</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20178318</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">20178318</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20178318</span> <span class="mi">0</span><span class="p">.</span><span class="mi">19533157</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20577049</span> <span class="mi">0</span><span class="p">.</span><span class="mi">19533157</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">19533157</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20178318</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20178318</span> <span class="mi">0</span><span class="p">.</span><span class="mi">19533157</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20577049</span><span class="p">]]</span>

<span class="n">Probability</span> <span class="n">distribution</span> <span class="k">of</span> <span class="n">the</span> <span class="n">secret</span> <span class="nb">number</span> <span class="k">in</span> <span class="mi">50</span> <span class="n">steps</span>
<span class="p">[[</span><span class="mi">0</span><span class="p">.</span><span class="mi">20001</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">19999191</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20000309</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20000309</span> <span class="mi">0</span><span class="p">.</span><span class="mi">19999191</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">19999191</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20001</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">19999191</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20000309</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20000309</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">20000309</span> <span class="mi">0</span><span class="p">.</span><span class="mi">19999191</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20001</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">19999191</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20000309</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">20000309</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20000309</span> <span class="mi">0</span><span class="p">.</span><span class="mi">19999191</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20001</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">19999191</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">19999191</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20000309</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20000309</span> <span class="mi">0</span><span class="p">.</span><span class="mi">19999191</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20001</span>   <span class="p">]]</span>

<span class="n">Probability</span> <span class="n">distribution</span> <span class="k">of</span> <span class="n">the</span> <span class="n">secret</span> <span class="nb">number</span> <span class="k">in</span> <span class="mi">100</span> <span class="n">steps</span>
<span class="p">[[</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">]]</span>
</code></pre></div>


<p>As the future horizon gets more distant, the transition distributions appear to converge, and the current state becomes less important in determining the more distant future. If <span class="math">\(n\)</span> gets really large and the Markov chain is run for a very long time, all the rows of the long-range transition matrix will become equal, and the probability of ending up in any particular state is <span class="math">\(\frac{1}{\text{n. states}}\)</span> for each of the states. These long-range probabilities are equal to what is called the <strong>stationary distribution</strong> of the Markov chain. The stationary distribution of a chain is the initial state distribution for which performing a transition will not change the probability of ending up in any given state.</p>
<p>Moreover, if a Markov chain is simulated for many iterations, the samples can be used as a Monte Carlo sample from the chain's stationary distribution. In order to simulate from a complicated posterior distribution, one can simulate a Markov chain whose stationary distribution is the posterior distribution. However, a Markov chain must have certain properties for its stationary distribution to exist.</p>
<h1>Continuous Markov Chain</h1>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">continous_markov_chain</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">markov_chain_sample</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.06</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">markov_chain_sample</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">phi</span> <span class="o">*</span> <span class="n">markov_chain_sample</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">markov_chain_sample</span><span class="p">[</span><span class="mi">200</span><span class="p">:])</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">continous_markov_chain</span><span class="p">(</span><span class="mi">500</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">continous_markov_chain</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>


<p><img alt="image alt text" src="https://gastonamengual.github.io/images/markov_chains_3.png"></p>
<p><img alt="image alt text" src="https://gastonamengual.github.io/images/markov_chains_4.png"></p>
<p>The theoretical stationary distribution for this chain is normal with mean <span class="math">\(0\)</span> and variance <span class="math">\(\dfrac{1}{1 - \phi^2} = 1.0036\)</span>. Looking at the histogram, it can be concluded that the chain has reached the stationary distribution. Therefore, this distribution was sampled not by its analytic formula, but from simulating a Markov chain whose stationary distribution is the desired distribution <span class="math">\(N \sim (0, 1.0018)\)</span>.</p>
<hr>

<h1>References</h1>
<p>Bayesian Statistics: Techniques and Models - University of California Santa Cruz - Coursera </p>
<p>https://www.wikiwand.com/en/Markov_chain</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
        </section>
      </div>

      <br><br>

    </article>


    <footer>
        <p>
          &copy;
          2021          Gastón Amengual
        </p>
    </footer>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-6KC62F9717"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());
  gtag('config', "G-6KC62F9717");</script>  </body>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    tex2jax: { inlineMath: [["$","$"],["\\(","\\)"]] },
    "HTML-CSS": {
      linebreaks: { automatic: true, width: "container" }
    }
    });
  </script>
</html>