<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Meta -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta charset="utf-8">

    <title>Singular Value Decomposition &ndash; Gastón Amengual</title>

    <!-- PWA -->
    <link rel="manifest" href="{static}/images/manifest.json">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Gastón Amengual">
    <meta name="apple-mobile-web-app-title" content="Gastón Amengual">
    <meta name="theme-color" content="#4a2964">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" sizes="180x180" href="{static}images/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="{static}/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="{static}/images/favicon/favicon-16x16.png">

    <!-- Social -->
    <meta property="article:author" content="Gastón Amengual" />
    <meta property="article:section" content="Machine Learning" />
    <meta property="article:published_time" content="2020-12-14" />

    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Singular Value Decomposition"/>
    <meta property="og:description" content="Theoretical explanation of the SVD, from-scratch implementation and application on an image."/>
    <meta property="og:site_name" content="Gastón Amengual" />
    <meta property="og:url" content="https://gastonamengual.github.io/singular-value-decomposition.html"/>

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Singular Value Decomposition">
    <meta name="twitter:description" content="Theoretical explanation of the SVD, from-scratch implementation and application on an image.">
    <meta name="twitter:url" content="https://gastonamengual.github.io/singular-value-decomposition.html">

    <!-- Feed -->

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:regular,bold">
    <link rel="stylesheet" type="text/css" href="https://gastonamengual.github.io/theme/css/w3.css">
    <link rel="stylesheet" type="text/css" href="https://gastonamengual.github.io/theme/css/style.css">

    <!-- Icon -->

    <!-- JavaScript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  </head>

  <body>
    <div class="w3-row w3-card w3-white">
      <header id="header">
        <a href="https://gastonamengual.github.io" id="header-logo" title="Home">GA</a>
        <nav id="header-menu">
          <ul>
            <li class="w3-bottombar w3-border-white w3-hover-border-purple"><a href="https://gastonamengual.github.io/">About</a></li>
            <li class="w3-bottombar w3-border-white w3-hover-border-purple"><a href="https://gastonamengual.github.io/pages/portfolio.html">Portfolio</a></li>
            <li class="w3-bottombar w3-border-white w3-hover-border-purple"><a href="/categories.html">Articles</a></li>
          </ul>
        </nav>
      </header>
    </div>



    <br><br>

    <article>
      <header class="w3-container col-main">
        <h1>Singular Value Decomposition</h1>
        <div class="post-info">
          <div class="w3-opacity w3-margin-right w3-margin-bottom" style="flex-grow: 1;">
            <span><time datetime="2020-12-14T00:00:00+01:00">Mon 14 December 2020</time> in <a href="https://gastonamengual.github.io/category/machine-learning.html" title="All articles in category Machine Learning">Machine Learning</a></span>
          </div>
        </div>
      </header>



      <div class="col-main w3-container">
        <section id="content">
          <p><strong>Notebook written by Gastón Amengual.</strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.image</span> <span class="kn">import</span> <span class="n">imread</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;bmh&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.titlesize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">17</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;lines.linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;lines.markersize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.prop_cycle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mediumpurple&quot;</span><span class="p">,</span> <span class="s2">&quot;saddlebrown&quot;</span><span class="p">,</span> <span class="s2">&quot;deepskyblue&quot;</span><span class="p">,</span> <span class="s2">&quot;olivedrab&quot;</span><span class="p">,</span> <span class="s2">&quot;darkseagreen&quot;</span><span class="p">,</span> 
                                                    <span class="s2">&quot;darkkhaki&quot;</span><span class="p">,</span> <span class="s2">&quot;darkgoldenrod&quot;</span><span class="p">,</span> <span class="s2">&quot;darkcyan&quot;</span><span class="p">,</span> <span class="s2">&quot;firebrick&quot;</span><span class="p">,</span> <span class="s2">&quot;palevioletred&quot;</span><span class="p">])</span>
</code></pre></div>


<p>Let $X = \begin{bmatrix}  | &amp; | &amp; | &amp; | \  x_1 &amp; x_2 &amp; \dotsc &amp; x_m \  | &amp; | &amp; | &amp; | \end{bmatrix} \in \mathbb{C}^{nxm}$ be a matrix representing data points, where:</p>
<ul>
<li>
<p>Each row $X_k \in \mathbb{C}^m$ is a variable or dimension of the data.</p>
</li>
<li>
<p>Each column $X_k \in \mathbb{C}^n$ is an observation or measurement from simulations or experiments. The index $k$ indicates the $k^{th}$ set of measurements or observations.</p>
</li>
</ul>
<p>The method to be explained is specially useful when $n \gg m$ (more dimensions than observations), i.e. high dimensional problems, resulting in a tall-skinny matrix, as opposed to a short-fat matrix when $n \ll m$ (more observations than dimensions).</p>
<p>The <strong>SVD</strong> is a unique matrix decomposition that exists for every complex-values matrix $X \in \mathbb{C}^{nxm}$:</p>
<p>$$X = U \Sigma V^* \quad (1)$$</p>
<p>where $U \in \mathbb{C}^{n \times n}$ and $V \in \mathbb{C}^{m \times m}$ are unitary matrices$_{[1]}$. When $n \geq m$ the matrix $\Sigma$ has at most $m$ non-zero elements on the diagonal, and may be written as $\Sigma = \begin{bmatrix} \hat{\Sigma} \ 0 \end{bmatrix}$. Therefore, it is possible to exactly represent $X$ using the <strong>economy SVD</strong>:</p>
<p>$$X = U\Sigma V^<em> = \hat{U} \hat{\Sigma} V^</em>$$</p>
<p>where $\hat{U}$ are the first $m$ columns of $U$. The columns of $U$ are called <strong>left singular vectors of X</strong> and the columns of V are <strong>right singular vectors</strong>. The diagonal elements of $\Sigma$, $\sigma_i$, are called <strong>singular values</strong>, and they are ordered so that $\sigma_{i+1} \leq \sigma_i$, i.e., from largest to smallest. The rank of $X$ is equal to the number of non-zero singular values.</p>
<p>SVD generalizes the eigendecomposition of a square normal matrix to any $m \times n$ matrix via an extension of the polar decomposition. It is numerically stable and provides a hierarchical representation of the data in terms of a new coordinate system defined by dominant correlations within the data. Moreover, the SVD is guaranteed to exist for any matrix, unlike the eigendecomposition.</p>
<p><strong>Geometric Interpretation</strong></p>
<p>If $M$ is an $n \times n$ real square matrix, the matrices $U$ and $V^T$ can be chosen to be real $n \times n$, too, which represent rotations or reflection of the space $R^n$, while $\Sigma$ represents the scaling of each coordinate $X_i$ by the factor $\sigma_i$. Thus the SVD decomposition breaks down any invertible linear transformation of $R^n$ into a composition of three geometrical transformations: a rotation or reflection ($V^*$), a coordinate-by-coordinate scaling ($\Sigma$), and a second rotation or reflection ($U$).</p>
<h1>Interpretation as dominant correlations</h1>
<p>The SVD is related to an eigenvalue problem involving the correlation matrices $XX^T$ and $X^TX$:</p>
<p>$X^T = V \Sigma U^T$</p>
<p>$XX^T = U \Sigma V^T V \Sigma U^T = U \hat{\Sigma^2} U^T$</p>
<p>$X^TX = V \Sigma U^T U \Sigma V^T = V \hat{\Sigma^2} V^T$</p>
<p>Recalling that $U$ and $V$ are unitary, multiplying each equation's side by $U$ and $V$, respectively, $U$; $\Sigma$; and $V$ are solutions to the following eigenvalue problems:</p>
<p>$X X^T U = U \hat{\Sigma^2} \quad (2)$</p>
<p>$X^T X V = V \hat{\Sigma^2} \quad (3)$</p>
<ul>
<li>
<p>The non-negative singular values of $X$ are the square root of the non-negative eigenvalue\s of $X^TX$ and of $XX^T$, and are arranged in descending order by magnitude, and thus the columns of $U$ are hierarchically ordered by how much correlation they capture in the columns of $X$; and the columns of $V$ similarly captures correlation in the rows of $X$.</p>
</li>
<li>
<p>The left-singular vectors of $X$ are a set of orthonormal eigenvectors of of the correlation matrix $XX^T$, </p>
</li>
<li>
<p>The right-singular vectors of $X$ are a set of orthonormal eigenvectors of $X^TX$. </p>
</li>
</ul>
<h1>Truncated SVD</h1>
<p>The sum of the squares of the singular values should be equal to the total variance in $X$, and each one tells how much of the total variance is accounted for by each singular vector. Often, a <strong>truncated SVD</strong> is calculated, truncating the SVD at a rank $r$ that captures a pre-determined amount of the variance or energy in the original matrix:</p>
<p>$$a_{ij} = \sum_{k=1}^{r} u_{ik} \sigma_k v_{jk}$$</p>
<h2>Election of $r$</h2>
<p>Deciding how many singular values to keep (i.e. the rank $r$) is one of the most important and contentious decisions when using the SVD. There are many factors, including specifications on the desired rank of the system, the magnitude of noise, and the distribution of the singular values. </p>
<h3>Percentage of explained variance captured</h3>
<p>The SVD can be truncated at a rank $r$ that captures a pre-determined amount of the variance or energy in the original data, such as $90%$ or $99%$ truncation.</p>
<h3>Elbow method</h3>
<p>Other techniques involve identifying "elbows" in the singular value distribution, which may denote the transition from singular values that represent important variance percentage from those that represent low information.</p>
<h3>Gavish-Donoho</h3>
<p>According to <a href="https://arxiv.org/abs/1305.5870">Gavish-Donoho (2014)</a>, for non squared matrices, the optimal value of $r$ is calculated as</p>
<p>$r = \omega(\beta) \cdot median(S)$</p>
<p><img alt="image.png" src="gavish_danoho_coefficients.png"></p>
<p>where $\beta = \left{\begin{matrix}
\frac{n}{m} &amp; \text{if} \quad n &lt; m\ 
\frac{m}{n} &amp; \text{if} \quad m &lt; n
\end{matrix}\right.$</p>
<h3>Notes</h3>
<p><strong>Conjugate transpose</strong></p>
<p>The conjugate transpose or Hermitian transpose of an $n \times m$ matrix $A$ with complex entries is the $n \times m$ matrix obtained from $A$ by taking the transpose and then taking the complex conjugate of each entry (the complex conjugate of $a+ib$ is $a-ib$, for real numbers $a$ and $b$). It is denoted as $A^H$ or $A^<em>$. For real matrices, the conjugate transpose is just the transpose, $A^</em>=A^T$.</p>
<p><strong>[1] Unitary vs orthogonal matrix</strong></p>
<p>In linear algebra, a complex square matrix $U$ is unitary if its conjugate transpose $U^<em>$ is also its inverse, that is, if $UU^</em> = U^*U = I$, where $I$ is the identity matrix. For real numbers, unitary and orthogonal means the same.</p>
<h1>Image Approximation</h1>
<div class="highlight"><pre><span></span><code><span class="n">X</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s1">&#39;piano.jpg&#39;</span><span class="p">)</span>
<span class="c1"># X = np.mean(A, -1) # Grayscale image</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">VT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># OPTIMAL R</span>
<span class="n">beta</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">omega</span> <span class="o">=</span> <span class="mf">2.8582</span>
<span class="n">r_optimal</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="o">*</span> <span class="n">omega</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">rs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="n">r_optimal</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">size</span><span class="p">]</span>

<span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span> <span class="n">axes</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
    <span class="n">approximation</span> <span class="o">=</span> <span class="n">U</span><span class="p">[:,</span> <span class="p">:</span><span class="n">r</span><span class="p">]</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">S</span><span class="p">)[:</span><span class="n">r</span><span class="p">,</span> <span class="p">:</span><span class="n">r</span><span class="p">]</span> <span class="o">@</span> <span class="n">VT</span><span class="p">[:</span><span class="n">r</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">megabytes</span> <span class="o">=</span> <span class="p">(</span><span class="n">U</span><span class="p">[:,</span> <span class="p">:</span><span class="n">r</span><span class="p">]</span><span class="o">.</span><span class="n">nbytes</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">S</span><span class="p">)[:</span><span class="n">r</span><span class="p">,</span> <span class="p">:</span><span class="n">r</span><span class="p">]</span><span class="o">.</span><span class="n">nbytes</span> <span class="o">+</span> <span class="n">VT</span><span class="p">[:</span><span class="n">r</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">nbytes</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
    <span class="n">variance_explained</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">S</span><span class="p">[:</span><span class="n">r</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">approximation</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s1"> Singular Values - </span><span class="si">{</span><span class="n">megabytes</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> MB - </span><span class="si">{</span><span class="n">variance_explained</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">% explained&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="n">axes</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Original Image - </span><span class="si">{</span><span class="n">megabytes</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> MB&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="n">axes</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s1"> Singular Value - </span><span class="si">{</span><span class="n">megabytes</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> MB - </span><span class="si">{</span><span class="n">variance_explained</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">% explained&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>

    <span class="n">img</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Singular Value Decomposition on Image Compression&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;piano_svd.jpg&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>


<p><img alt="image alt text" src="https://gastonamengual.github.io/images/singular_value_decomposition_1.png"></p>
<div class="highlight"><pre><span></span><code><span class="c1"># VARIANCE EXPLAINED</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">S</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cadetblue&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">r_optimal</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">S</span><span class="p">[:</span><span class="n">r_optimal</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">S</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;saddlebrown&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gavish-Donoho Optimal $r$ Value&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">S</span><span class="p">[:</span><span class="n">r_optimal</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">S</span><span class="p">),</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">r_optimal</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;saddlebrown&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">r_optimal</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">S</span><span class="p">[:</span><span class="n">r_optimal</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">S</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;saddlebrown&#39;</span><span class="p">)</span>

<span class="n">yticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">))</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">S</span><span class="p">[:</span><span class="n">r_optimal</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">S</span><span class="p">)],</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">yticks</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">S</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">xticks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="p">[</span><span class="n">r_optimal</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="n">S</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$r$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Explained Variance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Cumulative Explained Variance&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;variance_explained.jpg&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>


<p><img alt="image alt text" src="https://gastonamengual.github.io/images/singular_value_decomposition_2.png"></p>
<h1>References</h1>
<p>https://www.wikiwand.com/en/Singular_value_decomposition</p>
<p>https://jonathan-hui.medium.com/machine-learning-singular-value-decomposition-svd-principal-component-analysis-pca-1d45e885e491#:~:text=we%20discussed%20before.-,Principal%20Component%20Analysis%20(PCA),factors%20(k%20principal%20components).</p>
<p>https://www.wikiwand.com/en/Singular_value_decomposition</p>
<p>https://blog.statsbot.co/singular-value-decomposition-tutorial-52c695315254</p>
<p>Data Driven Science &amp; Engineering Machine Learning, Dynamical Systems, and Control - Brunton &amp; Kutz</p>
<p>Singular Value Decomposition - Steve Brunton -  https://www.youtube.com/playlist?list=PLMrJAkhIeNNSVjnsviglFoY2nXildDCcv</p>
<p>Lecture 47 — Singular Value Decomposition | Stanford University - https://www.youtube.com/watch?v=P5mlg91as1c&amp;t=819s</p>
<p>Lecture 48 — Dimensionality Reduction with SVD | Stanford University - https://www.youtube.com/watch?v=UyAfmAZU_WI&amp;t=314s</p>
        </section>

        <br><hr>

        <footer>

          <a href="http://www.linkedin.com/shareArticle?mini=true&url=https://gastonamengual.github.io/singular-value-decomposition.html&title=Singular Value Decomposition&source=https://gastonamengual.github.io" target="_blank" class="w3-btn w3-indigo">
            <span>Share article in LinkedIn!</span>
          </a>
          </a>
    
          <br><br><br>


        </footer>
      </div>
    </article>


    <footer id="footer">
      <div id="footer-copyright" class="w3-center w3-small w3-text-grey w3-padding-48">
        <span>
          &copy;
          2021          Gastón Amengual
        </span>
      </div>
    </footer>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'G-6KC62F9717', 'auto');
      ga('send', 'pageview');
    </script>

  </body>
</html>